<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Ares: BulletExt::BulletExt::ExtData Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="class_bullet_ext.html">BulletExt</a>::<a class="el" href="class_bullet_ext_1_1_ext_data.html">ExtData</a>
  </div>
</div>
<div class="contents">
<h1>BulletExt::BulletExt::ExtData Class Reference</h1><!-- doxytag: class="BulletExt::ExtData" --><!-- doxytag: inherits="Extension&lt; TT &gt;" --><code>#include &lt;/home/renegade/development/ares/Ext/Bullet/Body.h&gt;</code>
<p>
<div class="dynheader">
Inheritance diagram for BulletExt::BulletExt::ExtData:</div>
<div class="dynsection">

<p><center><img src="class_bullet_ext_1_1_ext_data.png" usemap="#BulletExt::BulletExt::ExtData_map" border="0" alt=""></center>
<map name="BulletExt::BulletExt::ExtData_map">
<area href="class_extension.html" alt="Extension< TT >" shape="rect" coords="0,0,163,24">
</map>
</div>

<p>
<a href="class_bullet_ext_1_1_ext_data-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bullet_ext_1_1_ext_data.html#a7f66ef582e349afe96695e210aa29c8">ExtData</a> (const DWORD <a class="el" href="class_extension.html#2f0c543d5bceafd46d103be4f87a5abe">Canary</a>=0, const <a class="el" href="class_bullet_ext.html#0af4200a0e57e1989fd519e42863006c">TT</a> *OwnerObject=NULL)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bullet_ext_1_1_ext_data.html#819ce3b613e68f041639f552c350a530">~ExtData</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual size_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bullet_ext_1_1_ext_data.html#12b7a9fd2c818556e3dc259463ee759e">Size</a> () const </td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_bullet_ext_1_1_ext_data.html#a3afac5846ade163b708d9d5b9007e53">DamageOccupants</a> ()</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Does the entire PassThrough logic, checks &amp; damage.  <a href="#a3afac5846ade163b708d9d5b9007e53"></a><br></td></tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="a7f66ef582e349afe96695e210aa29c8"></a><!-- doxytag: member="BulletExt::ExtData::ExtData" ref="a7f66ef582e349afe96695e210aa29c8" args="(const DWORD Canary=0, const TT *OwnerObject=NULL)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">BulletExt::BulletExt::ExtData::ExtData           </td>
          <td>(</td>
          <td class="paramtype">const DWORD&nbsp;</td>
          <td class="paramname"> <em>Canary</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_bullet_ext.html#0af4200a0e57e1989fd519e42863006c">TT</a> *&nbsp;</td>
          <td class="paramname"> <em>OwnerObject</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<div class="fragment"><pre class="fragment"><a name="l00026"></a>00026 { };
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="819ce3b613e68f041639f552c350a530"></a><!-- doxytag: member="BulletExt::ExtData::~ExtData" ref="819ce3b613e68f041639f552c350a530" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual BulletExt::BulletExt::ExtData::~ExtData           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<div class="fragment"><pre class="fragment"><a name="l00028"></a>00028                                    {
<a name="l00029"></a>00029                 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="a3afac5846ade163b708d9d5b9007e53"></a><!-- doxytag: member="BulletExt::ExtData::DamageOccupants" ref="a3afac5846ade163b708d9d5b9007e53" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool BulletExt::BulletExt::ExtData::DamageOccupants           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Does the entire PassThrough logic, checks &amp; damage. 
<p>
This function determines whether the projectile should pass through the outter shell of a building and damage the occupants instead.<p>
If so, it proceeds to damage the occupants, and then returns true. If the projectile did not pass through, and the building has to be damaged according to normal rules. the function returns false.<p>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>true if the bullet passed through and the damage case was handled, otherwise false.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>Renegade </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>02.12.09+ </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00020"></a>00020                                                {
<a name="l00021"></a>00021         BulletClass* TheBullet = this-&gt;<a class="code" href="class_extension.html#625b5030da4ce593b307c3a331248eca">AttachedToObject</a>;
<a name="l00022"></a>00022         BuildingClass* Building = NULL;
<a name="l00023"></a>00023 
<a name="l00024"></a>00024         <span class="keywordflow">if</span>(TheBullet-&gt;Target-&gt;WhatAmI() == abs_Building) {
<a name="l00025"></a>00025                 BuildingClass* Building = <span class="keyword">reinterpret_cast&lt;</span>BuildingClass *<span class="keyword">&gt;</span> (TheBullet-&gt;Target);
<a name="l00026"></a>00026         } <span class="keywordflow">else</span> {
<a name="l00027"></a>00027                 <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// target is not a building, so nothing to do</span>
<a name="l00028"></a>00028         }
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="keywordflow">if</span>(Building) { <span class="comment">// if that pointer is null, something went wrong</span>
<a name="l00031"></a>00031                 <a class="code" href="class_bullet_type_ext_1_1_ext_data.html">BulletTypeExt::ExtData</a>* TheBulletTypeExt = <a class="code" href="class_bullet_type_ext.html#7dc0a4583e92987bd0b670ed627aef26">BulletTypeExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(TheBullet-&gt;Type);
<a name="l00032"></a>00032                 <a class="code" href="class_building_type_ext_1_1_ext_data.html">BuildingTypeExt::ExtData</a>* BuildingAresData = <a class="code" href="class_building_type_ext.html#9643fa629dd6d2a20eeefa4942d8612a">BuildingTypeExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Building-&gt;Type);
<a name="l00033"></a>00033 
<a name="l00034"></a>00034                 <span class="keywordflow">if</span>(Building-&gt;Occupants.Count &amp;&amp; BuildingAresData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#4274f2da0b95141162610c3fddb409e8" title="How many percent of the shots pass through the building to the occupants? 0.0 = 0%...">UCPassThrough</a>) { <span class="comment">// only work when UCPassThrough is set, as per community vote in thread #1392</span>
<a name="l00035"></a>00035                         <span class="keywordflow">if</span>(!TheBulletTypeExt-&gt;<a class="code" href="class_bullet_type_ext_1_1_ext_data.html#b91b332bbf0e909781282037bc5cbc1b">SubjectToTrenches</a> || ((ScenarioClass::Instance-&gt;Randomizer.RandomRanged(0, 99) / 100) &lt; BuildingAresData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#4274f2da0b95141162610c3fddb409e8" title="How many percent of the shots pass through the building to the occupants? 0.0 = 0%...">UCPassThrough</a>)) { <span class="comment">// test for negative b/c being SubjectToTrenches means "we're getting stopped by trenches".</span>
<a name="l00036"></a>00036                                 <span class="keywordtype">int</span> poorBastard = ScenarioClass::Instance-&gt;Randomizer.RandomRanged(0, Building-&gt;Occupants.Count - 1); <span class="comment">// which Occupant is getting it?</span>
<a name="l00037"></a>00037                                 <span class="keywordflow">if</span>(BuildingAresData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#6cccf17f0703b5e5014e377bb5ebe9c4" title="Chance of an occupant getting killed instantly when a bullet passes through. 0.0...">UCFatalRate</a> &amp;&amp; ((ScenarioClass::Instance-&gt;Randomizer.RandomRanged(0, 99) / 100) &lt; BuildingAresData-&gt;<a class="code" href="class_building_type_ext_1_1_ext_data.html#6cccf17f0703b5e5014e377bb5ebe9c4" title="Chance of an occupant getting killed instantly when a bullet passes through. 0.0...">UCFatalRate</a>)) {
<a name="l00038"></a>00038                                         <span class="comment">// fatal hit</span>
<a name="l00039"></a>00039                                         Building-&gt;Occupants[poorBastard]-&gt;Destroyed(TheBullet-&gt;Owner);
<a name="l00040"></a>00040                                 } <span class="keywordflow">else</span> {
<a name="l00041"></a>00041                                         <span class="comment">/* ReceiveDamage args:</span>
<a name="l00042"></a>00042 <span class="comment">                                        virtual eDamageState ReceiveDamage(int* pDamage, int DistanceFromEpicenter, WarheadTypeClass* pWH,</span>
<a name="l00043"></a>00043 <span class="comment">                                                ObjectClass* Attacker, bool IgnoreDefenses, bool PreventPassengerEscape, HouseClass* pAttackingHouse) R0;</span>
<a name="l00044"></a>00044 <span class="comment">                                                where</span>
<a name="l00045"></a>00045 <span class="comment">                                                DistanceFromEpicenter -&gt; used for CellSpread/PercentAtMax</span>
<a name="l00046"></a>00046 <span class="comment">                                                IgnoreDefenses -&gt; ignore Immune=yes</span>
<a name="l00047"></a>00047 <span class="comment">                                        */</span>
<a name="l00048"></a>00048 
<a name="l00049"></a>00049                                         <span class="comment">// just a flesh wound</span>
<a name="l00050"></a>00050                                         <span class="keywordtype">int</span> adjustedDamage = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (ceil(TheBullet-&gt;Health * UCDamageMultiplier)); <span class="comment">// Bullet-&gt;Health is the damage it delivers (go Westwood)</span>
<a name="l00051"></a>00051                                         Building-&gt;Occupants[poorBastard]-&gt;ReceiveDamage(&amp;adjustedDamage, 0, TheBullet-&gt;WH, TheBullet-&gt;Owner, <span class="keyword">false</span>, <span class="keyword">true</span>, TheBullet-&gt;GetOwningHouse()) R0;
<a name="l00052"></a>00052                                 }
<a name="l00053"></a>00053                                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00054"></a>00054                         } <span class="keywordflow">else</span> {
<a name="l00055"></a>00055                                 <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no damage dealt b/c bullet was SubjectToTrenches=yes and UC.PassThrough did not apply</span>
<a name="l00056"></a>00056                         }
<a name="l00057"></a>00057                 } <span class="keywordflow">else</span> {
<a name="l00058"></a>00058                         <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no damage dealt b/c either there were no occupants, or UC.PassThrough is set to 0</span>
<a name="l00059"></a>00059                 }
<a name="l00060"></a>00060         } <span class="keywordflow">else</span> {
<a name="l00061"></a>00061                 <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// no damage dealt b/c the building-pointer was NULL (which is concerning)</span>
<a name="l00062"></a>00062         }
<a name="l00063"></a>00063 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="12b7a9fd2c818556e3dc259463ee759e"></a><!-- doxytag: member="BulletExt::ExtData::Size" ref="12b7a9fd2c818556e3dc259463ee759e" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual size_t BulletExt::BulletExt::ExtData::Size           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>Implements <a class="el" href="class_extension.html#44ddedd12613b24b7b03d21982782047">Extension&lt; TT &gt;</a>.</p>
<div class="fragment"><pre class="fragment"><a name="l00031"></a>00031 { <span class="keywordflow">return</span> <span class="keyword">sizeof</span>(*this); };
</pre></div>
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Ext/Bullet/<a class="el" href="_bullet_2_body_8h.html">Body.h</a><li>Ext/Bullet/<a class="el" href="_bullet_2_body_8cpp.html">Body.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Thu Dec 17 09:37:30 2009 for Ares by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
