<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Ares: EMPulse Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>EMPulse Class Reference</h1><!-- doxytag: class="EMPulse" --><code>#include &lt;Misc/EMPulse.h&gt;</code>
<p>

<p>
<a href="class_e_m_pulse-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#3e0094465ad4c648cec89a498c6bbe38">CreateEMPulse</a> (EMPulseClass *Legacy, TechnoClass *Firer)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#d991d453848ef076fa8cf0530a1b9125">CreateEMPulse</a> (<a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *Warhead, CellStruct Target, TechnoClass *Firer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Paralyses all units using an EMP cellspread weapon.  <a href="#d991d453848ef076fa8cf0530a1b9125"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#46041f950a72e7479ba8d47e93937b5a">DisableEMPEffect</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets all properties to re-enable a Techno.  <a href="#46041f950a72e7479ba8d47e93937b5a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#cae411b2800c152fdb7647c912a421e0">IsTypeEMPProne</a> (TechnoTypeClass *Type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether an EMP would have an effect on a TechnoType.  <a href="#cae411b2800c152fdb7647c912a421e0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#e2a7d8be2beb4057f72e5aec4f2cdcb1">IsDeactivationAdvisable</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether this Techno should be deactivated right now.  <a href="#e2a7d8be2beb4057f72e5aec4f2cdcb1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239">UpdateSparkleAnim</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the sparkle animation of Techno.  <a href="#61f0c37d20dc3bc29f34d497b456c239"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#8bf999e351f0c86e0ae7130ca2d57248">deliverEMPDamage</a> (ObjectClass *, TechnoClass *, <a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deals EMP damage the object..  <a href="#8bf999e351f0c86e0ae7130ca2d57248"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#42ff43d73b38e829f54e42f5ca5daade">isEMPTypeImmune</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is type immune to EMP.  <a href="#42ff43d73b38e829f54e42f5ca5daade"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#5871a06d4aaa50bf1b3cc0b6b37936cf">isEMPImmune</a> (TechnoClass *, HouseClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is immune to an EMP fired by a house.  <a href="#5871a06d4aaa50bf1b3cc0b6b37936cf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#12fb80c513248acdd3e1e64a13fb91e2">isCurrentlyEMPImmune</a> (TechnoClass *, HouseClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is currently immune to EMPs fired by a house.  <a href="#12fb80c513248acdd3e1e64a13fb91e2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#ba6c1cd17600a649e0c4f282825cd850">isEligibleEMPTarget</a> (TechnoClass *, HouseClass *, WarheadTypeClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is a valid target for EMPs fired by a house.  <a href="#ba6c1cd17600a649e0c4f282825cd850"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#3ec979d32354b0e4decb6b32eec85eba">getCappedDuration</a> (int, int, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the new duration the EMP effect will last.  <a href="#3ec979d32354b0e4decb6b32eec85eba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b">updateRadarBlackout</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the radar outage for the owning player to match the current EMP effect duration.  <a href="#e45b8d77bd3cd58bb1bfaf647af2656b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e">updateSpawnManager</a> (TechnoClass *, ObjectClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the SpawnManager to account for the EMP effect.  <a href="#b8e45e0a1a4ed89481378782b5ef9d7e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b">updateSlaveManager</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the SlaveManager to account for the EMP effect.  <a href="#9861f36902003925c8aaea5082f0121b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#8cb96ccf83aa30ecbf474d625f1cf6ef">enableEMPEffect</a> (TechnoClass *, ObjectClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets all properties to disable a Techno.  <a href="#8cb96ccf83aa30ecbf474d625f1cf6ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#85881f5b68e24bef805079881666bceb">announceAttack</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If the victim is owned by the human player creates radar events and EVA warnings.  <a href="#85881f5b68e24bef805079881666bceb"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307">verbose</a> = true</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables verbose debug output for some <a class="el" href="class_warhead_type_ext.html">WarheadTypeExt</a> functions.  <a href="#c5be0a3f0350827da617ba594d1cd307"></a><br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="85881f5b68e24bef805079881666bceb"></a><!-- doxytag: member="EMPulse::announceAttack" ref="85881f5b68e24bef805079881666bceb" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::announceAttack           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
If the victim is owned by the human player creates radar events and EVA warnings. 
<p>
Creates a radar event and makes EVA tell you so if the Techno is a resource gatherer or harvester. If it is a building that can not be undeployed and counts as BaseNormal a base under attack event is raised.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that has been attacked.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-29 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00532"></a>00532                                                  {
<a name="l00533"></a>00533         <span class="keyword">enum</span> AttackEvents {None = 0, Base = 1, Harvester = 2};
<a name="l00534"></a>00534         AttackEvents rEvent = None;
<a name="l00535"></a>00535 
<a name="l00536"></a>00536         <span class="comment">// find out what event is the most appropriate.</span>
<a name="l00537"></a>00537         <span class="keywordflow">if</span> (Techno &amp;&amp; (Techno-&gt;Owner == HouseClass::Player)) {
<a name="l00538"></a>00538                 <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Techno)) {
<a name="l00539"></a>00539                         <span class="keywordflow">if</span>(Building-&gt;Type-&gt;ResourceGatherer) {
<a name="l00540"></a>00540                                 <span class="comment">// slave miner, for example</span>
<a name="l00541"></a>00541                                 rEvent = Harvester;
<a name="l00542"></a>00542                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!Building-&gt;Type-&gt;Insignificant &amp;&amp; !Building-&gt;Type-&gt;BaseNormal) {
<a name="l00543"></a>00543                                 rEvent = Base;
<a name="l00544"></a>00544                         }
<a name="l00545"></a>00545                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (UnitClass * Unit = specific_cast&lt;UnitClass *&gt;(Techno)) {
<a name="l00546"></a>00546                         <span class="keywordflow">if</span> (Unit-&gt;Type-&gt;Harvester || Unit-&gt;Type-&gt;ResourceGatherer) {
<a name="l00547"></a>00547                                 rEvent = Harvester;
<a name="l00548"></a>00548                         }
<a name="l00549"></a>00549                 }
<a name="l00550"></a>00550         }
<a name="l00551"></a>00551 
<a name="l00552"></a>00552         <span class="comment">// handle the event.</span>
<a name="l00553"></a>00553         <span class="keywordflow">if</span> (rEvent != None) {
<a name="l00554"></a>00554                 CellStruct xy;
<a name="l00555"></a>00555                 Techno-&gt;GetMapCoords(&amp;xy);
<a name="l00556"></a>00556 
<a name="l00557"></a>00557                 <span class="keywordflow">switch</span> (rEvent) {
<a name="l00558"></a>00558                         <span class="keywordflow">case</span> Harvester:
<a name="l00559"></a>00559                                 <span class="keywordflow">if</span> (RadarEventClass::Create(RADAREVENT_OREMINERUNDERATTACK, xy))
<a name="l00560"></a>00560                                         VoxClass::Play(<span class="stringliteral">"EVA_OreMinerUnderAttack"</span>, -1, -1);
<a name="l00561"></a>00561                                 <span class="keywordflow">break</span>;
<a name="l00562"></a>00562                         <span class="keywordflow">case</span> Base:
<a name="l00563"></a>00563                                 HouseClass::Player-&gt;BuildingUnderAttack(specific_cast&lt;BuildingClass *&gt;(Techno));
<a name="l00564"></a>00564                                 <span class="keywordflow">break</span>;
<a name="l00565"></a>00565                 }
<a name="l00566"></a>00566         }
<a name="l00567"></a>00567 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="d991d453848ef076fa8cf0530a1b9125"></a><!-- doxytag: member="EMPulse::CreateEMPulse" ref="d991d453848ef076fa8cf0530a1b9125" args="(WarheadTypeExt::ExtData *Warhead, CellStruct Target, TechnoClass *Firer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::CreateEMPulse           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CellStruct&nbsp;</td>
          <td class="paramname"> <em>Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Firer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Paralyses all units using an EMP cellspread weapon. 
<p>
All Technos in the EMPulse's target cells get affected by an EMP and get deactivated temporarily. Their special functions stop working until the EMP ceases. Flying Aircraft crashes.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="class_e_m_pulse.html">EMPulse</a></em>&nbsp;</td><td>The electromagnetic pulse to create. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Firer</em>&nbsp;</td><td>The Techno that fired the pulse.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-04 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00020"></a>00020                                                                                                   {
<a name="l00021"></a>00021         <span class="keywordflow">if</span> (!Warhead) {
<a name="l00022"></a>00022                 <a class="code" href="class_debug.html#4dcfff56d6e69bd62771feadb91014de">Debug::DevLog</a>(<a class="code" href="class_debug.html#38f58dd0c1bec9042ead4a8eea1f3db184c6ea9e411b9a465c18af311547f156">Debug::Error</a>, <span class="stringliteral">"Trying to CreateEMPulse() with Warhead pointing to NULL. Funny.\n"</span>);
<a name="l00023"></a>00023                 <span class="keywordflow">return</span>;
<a name="l00024"></a>00024         }
<a name="l00025"></a>00025 
<a name="l00026"></a>00026         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00027"></a>00027                 Debug::Log(<span class="stringliteral">"[CreateEMPulse] Duration: %d, Cap: %d\n"</span>, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#94e6b628222742c7b45bcee95aeb04be">EMP_Duration</a>, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#fe4a4a59145d61135b4e5e4efd8b4127">EMP_Cap</a>);
<a name="l00028"></a>00028         }
<a name="l00029"></a>00029 
<a name="l00030"></a>00030         <span class="comment">// the quick way. only look at stuff residing on the very cells we are affecting.</span>
<a name="l00031"></a>00031         CellStruct cellCoords = MapClass::Instance-&gt;GetCellAt(&amp;Coords)-&gt;MapCoords;
<a name="l00032"></a>00032         <span class="keywordtype">int</span> countCells = CellSpread::NumCells((<span class="keywordtype">int</span>)(Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;CellSpread + 0.99));
<a name="l00033"></a>00033         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; countCells; ++i) {
<a name="l00034"></a>00034                 CellStruct tmpCell = CellSpread::GetCell(i);
<a name="l00035"></a>00035                 tmpCell += cellCoords;
<a name="l00036"></a>00036                 CellClass *c = MapClass::Instance-&gt;GetCellAt(&amp;tmpCell);
<a name="l00037"></a>00037                 <span class="keywordflow">for</span> (ObjectClass *curObj = c-&gt;GetContent(); curObj; curObj = curObj-&gt;NextObject) {
<a name="l00038"></a>00038                         <a class="code" href="class_e_m_pulse.html#8bf999e351f0c86e0ae7130ca2d57248" title="Deals EMP damage the object..">deliverEMPDamage</a>(curObj, Firer, Warhead);
<a name="l00039"></a>00039                 }
<a name="l00040"></a>00040         }
<a name="l00041"></a>00041 
<a name="l00042"></a>00042         <span class="comment">// the not quite so fast way. skip everything not in the air.</span>
<a name="l00043"></a>00043         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;TechnoClass::Array-&gt;Count; ++i) {
<a name="l00044"></a>00044                 TechnoClass *Techno = (TechnoClass*)TechnoClass::Array-&gt;GetItem(i);
<a name="l00045"></a>00045                 <span class="keywordflow">if</span> (Techno-&gt;IsInAir()) {
<a name="l00046"></a>00046                         <span class="keywordflow">if</span> (Techno-&gt;GetCell()-&gt;MapCoords.DistanceFrom(cellCoords) &lt;= Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;CellSpread) {
<a name="l00047"></a>00047                                 <a class="code" href="class_e_m_pulse.html#8bf999e351f0c86e0ae7130ca2d57248" title="Deals EMP damage the object..">deliverEMPDamage</a>(Techno, Firer, Warhead);
<a name="l00048"></a>00048                         }
<a name="l00049"></a>00049                 }
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3e0094465ad4c648cec89a498c6bbe38"></a><!-- doxytag: member="EMPulse::CreateEMPulse" ref="3e0094465ad4c648cec89a498c6bbe38" args="(EMPulseClass *Legacy, TechnoClass *Firer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void EMPulse::CreateEMPulse           </td>
          <td>(</td>
          <td class="paramtype">EMPulseClass *&nbsp;</td>
          <td class="paramname"> <em>Legacy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Firer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="8bf999e351f0c86e0ae7130ca2d57248"></a><!-- doxytag: member="EMPulse::deliverEMPDamage" ref="8bf999e351f0c86e0ae7130ca2d57248" args="(ObjectClass *, TechnoClass *, WarheadTypeExt::ExtData *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::deliverEMPDamage           </td>
          <td>(</td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Firer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Deals EMP damage the object.. 
<p>
Applies, removes or alters the EMP effect on a given unit.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>object</em>&nbsp;</td><td>The Techno that should get affected by EMP.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00062"></a>00062                                                                                                       {
<a name="l00063"></a>00063         <span class="comment">// fill the gaps</span>
<a name="l00064"></a>00064         HouseClass *pHouse = (Firer ? Firer-&gt;Owner : NULL);
<a name="l00065"></a>00065         
<a name="l00066"></a>00066         <span class="keywordflow">if</span> (TechnoClass * curTechno = generic_cast&lt;TechnoClass *&gt; (<span class="keywordtype">object</span>)) {
<a name="l00067"></a>00067                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00068"></a>00068                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 1: %s =&gt; %s\n"</span>,
<a name="l00069"></a>00069                                         (Firer ? Firer-&gt;get_ID() : NULL),
<a name="l00070"></a>00070                                         curTechno-&gt;get_ID());
<a name="l00071"></a>00071                 }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#ba6c1cd17600a649e0c4f282825cd850" title="Gets whether a Techno is a valid target for EMPs fired by a house.">isEligibleEMPTarget</a>(curTechno, pHouse, Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>)) {
<a name="l00074"></a>00074                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00075"></a>00075                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 2: %s\n"</span>,
<a name="l00076"></a>00076                                                 curTechno-&gt;get_ID());
<a name="l00077"></a>00077                         }
<a name="l00078"></a>00078                         <span class="comment">// get the new capped value</span>
<a name="l00079"></a>00079                         <span class="keywordtype">int</span> oldValue = curTechno-&gt;EMPLockRemaining;
<a name="l00080"></a>00080                         <span class="keywordtype">int</span> newValue = <a class="code" href="class_e_m_pulse.html#3ec979d32354b0e4decb6b32eec85eba" title="Gets the new duration the EMP effect will last.">getCappedDuration</a>(oldValue, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#94e6b628222742c7b45bcee95aeb04be">EMP_Duration</a>, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#fe4a4a59145d61135b4e5e4efd8b4127">EMP_Cap</a>);
<a name="l00081"></a>00081 
<a name="l00082"></a>00082                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00083"></a>00083                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 3: %d\n"</span>,
<a name="l00084"></a>00084                                                 newValue);
<a name="l00085"></a>00085                         }
<a name="l00086"></a>00086 
<a name="l00087"></a>00087                         <span class="comment">// can not be less than zero</span>
<a name="l00088"></a>00088                         curTechno-&gt;EMPLockRemaining = max(0, newValue);
<a name="l00089"></a>00089                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00090"></a>00090                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 4: %d\n"</span>,
<a name="l00091"></a>00091                                                 newValue);
<a name="l00092"></a>00092                         }
<a name="l00093"></a>00093 
<a name="l00094"></a>00094                         <span class="comment">// newly de-paralyzed</span>
<a name="l00095"></a>00095                         <span class="keywordflow">if</span> ((oldValue &gt; 0) &amp;&amp; (curTechno-&gt;EMPLockRemaining &lt;= 0)) {
<a name="l00096"></a>00096                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00097"></a>00097                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5a\n"</span>);
<a name="l00098"></a>00098                                 }
<a name="l00099"></a>00099                                 <a class="code" href="class_e_m_pulse.html#46041f950a72e7479ba8d47e93937b5a" title="Sets all properties to re-enable a Techno.">DisableEMPEffect</a>(curTechno);
<a name="l00100"></a>00100                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((oldValue &lt;= 0) &amp;&amp; (curTechno-&gt;EMPLockRemaining &gt; 0)) {
<a name="l00101"></a>00101                                 <span class="comment">// newly paralyzed unit</span>
<a name="l00102"></a>00102                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00103"></a>00103                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5b\n"</span>);
<a name="l00104"></a>00104                                 }
<a name="l00105"></a>00105                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#8cb96ccf83aa30ecbf474d625f1cf6ef" title="Sets all properties to disable a Techno.">enableEMPEffect</a>(curTechno, Firer)) {
<a name="l00106"></a>00106                                         <span class="keywordflow">return</span>;
<a name="l00107"></a>00107                                 }
<a name="l00108"></a>00108                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oldValue != newValue) {
<a name="l00109"></a>00109                                 <span class="comment">// At least update the radar, if this is one.</span>
<a name="l00110"></a>00110                                 <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(curTechno);
<a name="l00111"></a>00111                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00112"></a>00112                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5c\n"</span>);
<a name="l00113"></a>00113                                 }
<a name="l00114"></a>00114                         }
<a name="l00115"></a>00115                 }
<a name="l00116"></a>00116         }
<a name="l00117"></a>00117 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="46041f950a72e7479ba8d47e93937b5a"></a><!-- doxytag: member="EMPulse::DisableEMPEffect" ref="46041f950a72e7479ba8d47e93937b5a" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::DisableEMPEffect           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Victim</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets all properties to re-enable a Techno. 
<p>
Reactivates the Techno. The EMP sparkle animation is stopped.<p>
Radars come back online. Spawners are allowed to resume their work.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Victim</em>&nbsp;</td><td>The Techno that shall have its EMP effects removed.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00650"></a>00650                                                    {
<a name="l00651"></a>00651         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Victim);
<a name="l00652"></a>00652         <span class="keywordtype">bool</span> HasPower = <span class="keyword">true</span>;
<a name="l00653"></a>00653 
<a name="l00654"></a>00654         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Victim)) {
<a name="l00655"></a>00655                 HasPower = Building-&gt;HasPower &amp;&amp; !(Building-&gt;Owner-&gt;PowerDrain &gt; Building-&gt;Owner-&gt;PowerOutput) ;
<a name="l00656"></a>00656 
<a name="l00657"></a>00657                 <span class="keywordflow">if</span> (!Building-&gt;Type-&gt;InvisibleInGame) {
<a name="l00658"></a>00658                         <span class="keywordflow">if</span> (HasPower) {
<a name="l00659"></a>00659                                 Building-&gt;EnableStuff();
<a name="l00660"></a>00660                         }
<a name="l00661"></a>00661                         <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(Building);
<a name="l00662"></a>00662                 }
<a name="l00663"></a>00663         }
<a name="l00664"></a>00664 
<a name="l00665"></a>00665         Victim-&gt;Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
<a name="l00666"></a>00666         Victim-&gt;Owner-&gt;PowerBlackout = <span class="keyword">true</span>;
<a name="l00667"></a>00667 
<a name="l00668"></a>00668         <span class="keywordflow">if</span> (Victim-&gt;Deactivated &amp;&amp; HasPower) {
<a name="l00669"></a>00669                 Victim-&gt;Reactivate();
<a name="l00670"></a>00670         }
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         <span class="comment">// allow to spawn units again.</span>
<a name="l00673"></a>00673         <a class="code" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e" title="Updates the SpawnManager to account for the EMP effect.">updateSpawnManager</a>(Victim);
<a name="l00674"></a>00674         <a class="code" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b" title="Updates the SlaveManager to account for the EMP effect.">updateSlaveManager</a>(Victim);
<a name="l00675"></a>00675 
<a name="l00676"></a>00676         <span class="comment">// update the animation</span>
<a name="l00677"></a>00677         <a class="code" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239" title="Updates the sparkle animation of Techno.">UpdateSparkleAnim</a>(Victim);
<a name="l00678"></a>00678 
<a name="l00679"></a>00679         <span class="comment">// get harvesters back to work.</span>
<a name="l00680"></a>00680         <span class="keywordflow">if</span> (UnitClass * Unit = specific_cast&lt;UnitClass *&gt;(Victim)) {
<a name="l00681"></a>00681                 <span class="keywordflow">if</span> (Unit-&gt;Type-&gt;Harvester || Unit-&gt;Type-&gt;ResourceGatherer) {
<a name="l00682"></a>00682                         Unit-&gt;QueueMission(pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#9b5284c0b77edaefb5b295f6a3be9ef5">EMPLastMission</a>, <span class="keyword">true</span>);
<a name="l00683"></a>00683                 }
<a name="l00684"></a>00684         }
<a name="l00685"></a>00685 }</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8cb96ccf83aa30ecbf474d625f1cf6ef"></a><!-- doxytag: member="EMPulse::enableEMPEffect" ref="8cb96ccf83aa30ecbf474d625f1cf6ef" args="(TechnoClass *, ObjectClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::enableEMPEffect           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Victim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>Source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets all properties to disable a Techno. 
<p>
Disables Buildings and crashes flying Aircrafts. Foots get deactivated. An EMP sparkle animation is created and played until the EMP effect ceases.<p>
Contains special handling to create a radar outage equalling the length of the EMP effect, if Victim is a Building with Radar capabilities.<p>
If Victim mind controls any units, they are freed. Spawned units are killed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Victim</em>&nbsp;</td><td>The Techno that is under EMP effect. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Source</em>&nbsp;</td><td>The house to credit kills to.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Victim has been destroyed by the EMP effect, False otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-04 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00589"></a>00589                                                                         {
<a name="l00590"></a>00590         Victim-&gt;Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
<a name="l00591"></a>00591         Victim-&gt;Owner-&gt;PowerBlackout = <span class="keyword">true</span>;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Victim)) {
<a name="l00594"></a>00594                 Building-&gt;DisableStuff();
<a name="l00595"></a>00595                 <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(Building);
<a name="l00596"></a>00596         } <span class="keywordflow">else</span> {
<a name="l00597"></a>00597                 <span class="keywordflow">if</span> (AircraftClass * Aircraft = specific_cast&lt;AircraftClass *&gt;(Victim)) {
<a name="l00598"></a>00598                         <span class="comment">// crash flying aircraft</span>
<a name="l00599"></a>00599                         <span class="keywordflow">if</span> (Aircraft-&gt;IsInAir()) {
<a name="l00600"></a>00600                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00601"></a>00601                                         Debug::Log(<span class="stringliteral">"[enableEMPEffect] Plane crash: %s\n"</span>, Aircraft-&gt;get_ID());
<a name="l00602"></a>00602                                 }
<a name="l00603"></a>00603                                 VocClass::PlayAt(Aircraft-&gt;Type-&gt;VoiceCrashing, &amp;Aircraft-&gt;Location, NULL);
<a name="l00604"></a>00604                                 Aircraft-&gt;Crash(Source);
<a name="l00605"></a>00605                                 Aircraft-&gt;Destroyed(Source);
<a name="l00606"></a>00606                                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00607"></a>00607                         }
<a name="l00608"></a>00608                 }
<a name="l00609"></a>00609         }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611         <span class="comment">// cache the last mission this thing did</span>
<a name="l00612"></a>00612         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Victim);
<a name="l00613"></a>00613         pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#9b5284c0b77edaefb5b295f6a3be9ef5">EMPLastMission</a> = Victim-&gt;CurrentMission;
<a name="l00614"></a>00614 
<a name="l00615"></a>00615         <span class="comment">// deactivate and sparkle.</span>
<a name="l00616"></a>00616         <span class="keywordflow">if</span> (!Victim-&gt;Deactivated &amp;&amp; <a class="code" href="class_e_m_pulse.html#e2a7d8be2beb4057f72e5aec4f2cdcb1" title="Gets whether this Techno should be deactivated right now.">IsDeactivationAdvisable</a>(Victim)) {
<a name="l00617"></a>00617                 Victim-&gt;Deactivate();
<a name="l00618"></a>00618         }
<a name="l00619"></a>00619 
<a name="l00620"></a>00620         <span class="comment">// release all captured units.</span>
<a name="l00621"></a>00621         <span class="keywordflow">if</span> (Victim-&gt;CaptureManager) {
<a name="l00622"></a>00622                 Victim-&gt;CaptureManager-&gt;FreeAll();
<a name="l00623"></a>00623         }
<a name="l00624"></a>00624 
<a name="l00625"></a>00625         <span class="comment">// update managers.</span>
<a name="l00626"></a>00626         <a class="code" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e" title="Updates the SpawnManager to account for the EMP effect.">updateSpawnManager</a>(Victim, Source);
<a name="l00627"></a>00627         <a class="code" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b" title="Updates the SlaveManager to account for the EMP effect.">updateSlaveManager</a>(Victim);
<a name="l00628"></a>00628 
<a name="l00629"></a>00629         <span class="comment">// set the sparkle animation.</span>
<a name="l00630"></a>00630         <a class="code" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239" title="Updates the sparkle animation of Techno.">UpdateSparkleAnim</a>(Victim);
<a name="l00631"></a>00631 
<a name="l00632"></a>00632         <span class="comment">// warn the player</span>
<a name="l00633"></a>00633         <a class="code" href="class_e_m_pulse.html#85881f5b68e24bef805079881666bceb" title="If the victim is owned by the human player creates radar events and EVA warnings...">announceAttack</a>(Victim);
<a name="l00634"></a>00634 
<a name="l00635"></a>00635         <span class="comment">// the unit still lives.</span>
<a name="l00636"></a>00636         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00637"></a>00637 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3ec979d32354b0e4decb6b32eec85eba"></a><!-- doxytag: member="EMPulse::getCappedDuration" ref="3ec979d32354b0e4decb6b32eec85eba" args="(int, int, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EMPulse::getCappedDuration           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>CurrentValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Cap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the new duration the EMP effect will last. 
<p>
The new EMP lock frames count is calculated the following way:<p>
If Duration is positive it will inflict EMP damage. If Cap is larger than zero, the maximum amount of frames will be defined by Cap. If the current value already is larger than that, in will not be reduced. If Cap is zero, then the duration can add up infinitely. If Cap is less than zero, duration will be set to Duration, if the current value is not higher already.<p>
If Duration is negative, the EMP effect will be reduced. A negative Cap reduces the current value by Duration. A positive or zero Cap will do the same, but additionally shorten it to Cap if the result would be higher than that. Thus, a Cap of zero removes the current EMP effect altogether.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentValue</em>&nbsp;</td><td>The Technos current remaining time. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Duration</em>&nbsp;</td><td>The duration the EMP uses. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Cap</em>&nbsp;</td><td>The maximum Duration this EMP can cause.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The new EMP lock frames count.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00377"></a>00377                                                                       {
<a name="l00378"></a>00378         <span class="comment">// Usually, the new duration is just added.</span>
<a name="l00379"></a>00379         <span class="keywordtype">int</span> ProposedDuration = CurrentValue + Duration;
<a name="l00380"></a>00380 
<a name="l00381"></a>00381         <span class="keywordflow">if</span> (Duration &gt; 0) {
<a name="l00382"></a>00382                 <span class="comment">// Positive damage.</span>
<a name="l00383"></a>00383                 <span class="keywordflow">if</span> (Cap &lt; 0) {
<a name="l00384"></a>00384                         <span class="comment">// Do not stack. Use the maximum value.</span>
<a name="l00385"></a>00385                         <span class="keywordflow">return</span> max(Duration, CurrentValue);
<a name="l00386"></a>00386                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Cap &gt; 0) {
<a name="l00387"></a>00387                         <span class="comment">// Cap the duration.</span>
<a name="l00388"></a>00388                         <span class="keywordtype">int</span> cappedValue = min(ProposedDuration, Cap);
<a name="l00389"></a>00389                         <span class="keywordflow">return</span> max(CurrentValue, cappedValue);
<a name="l00390"></a>00390                 } <span class="keywordflow">else</span> {
<a name="l00391"></a>00391                         <span class="comment">// There is no cap. Allow the duration to stack up.</span>
<a name="l00392"></a>00392                         <span class="keywordflow">return</span> ProposedDuration;
<a name="l00393"></a>00393                 }
<a name="l00394"></a>00394         } <span class="keywordflow">else</span> {
<a name="l00395"></a>00395                 <span class="comment">// Negative damage.</span>
<a name="l00396"></a>00396                 <span class="keywordflow">return</span> (Cap &lt; 0 ? ProposedDuration : min(ProposedDuration, Cap));
<a name="l00397"></a>00397         }
<a name="l00398"></a>00398 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="12fb80c513248acdd3e1e64a13fb91e2"></a><!-- doxytag: member="EMPulse::isCurrentlyEMPImmune" ref="12fb80c513248acdd3e1e64a13fb91e2" args="(TechnoClass *, HouseClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isCurrentlyEMPImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is currently immune to EMPs fired by a house. 
<p>
Target may not be immune to EMP but its current status still prevents it from being affected by them.<p>
Currently, EMPs can be temporarily averted if Target is under the influence of the Iron Curtain.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP is fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-02 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00239"></a>00239                                                                                  {
<a name="l00240"></a>00240         <span class="comment">// iron curtained objects can not be affected by EMPs</span>
<a name="l00241"></a>00241         <span class="keywordflow">if</span> (Target-&gt;IsIronCurtained()) {
<a name="l00242"></a>00242                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00243"></a>00243         }
<a name="l00244"></a>00244 
<a name="l00245"></a>00245         <span class="comment">// the current status does allow this target to</span>
<a name="l00246"></a>00246         <span class="comment">// be affected by EMPs. It may be immune, though.</span>
<a name="l00247"></a>00247         <span class="keywordflow">return</span> <a class="code" href="class_e_m_pulse.html#5871a06d4aaa50bf1b3cc0b6b37936cf" title="Gets whether a Techno is immune to an EMP fired by a house.">isEMPImmune</a>(Target, SourceHouse);
<a name="l00248"></a>00248 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e2a7d8be2beb4057f72e5aec4f2cdcb1"></a><!-- doxytag: member="EMPulse::IsDeactivationAdvisable" ref="e2a7d8be2beb4057f72e5aec4f2cdcb1" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::IsDeactivationAdvisable           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether this Techno should be deactivated right now. 
<p>
Objects that are currently deploying, constructing, or selling should not be deactivated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno to be deactivated.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target should be deactivated, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-09 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00335"></a>00335                                                           {
<a name="l00336"></a>00336         <span class="keywordflow">switch</span>(Target-&gt;CurrentMission)
<a name="l00337"></a>00337         {
<a name="l00338"></a>00338         <span class="keywordflow">case</span> mission_Selling:
<a name="l00339"></a>00339         <span class="keywordflow">case</span> mission_Construction:
<a name="l00340"></a>00340         <span class="keywordflow">case</span> mission_Unload:
<a name="l00341"></a>00341                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00342"></a>00342                         Debug::Log(<span class="stringliteral">"[IsDeactivationAdvisable] %s should not be disabled. Mission: %d\n"</span>, Target-&gt;get_ID(), Target-&gt;CurrentMission);
<a name="l00343"></a>00343                 }
<a name="l00344"></a>00344                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00345"></a>00345         }
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00348"></a>00348                 Debug::Log(<span class="stringliteral">"[IsDeactivationAdvisable] %s should be disabled. Mission: %d\n"</span>, Target-&gt;get_ID(), Target-&gt;CurrentMission);
<a name="l00349"></a>00349         }
<a name="l00350"></a>00350         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00351"></a>00351 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ba6c1cd17600a649e0c4f282825cd850"></a><!-- doxytag: member="EMPulse::isEligibleEMPTarget" ref="ba6c1cd17600a649e0c4f282825cd850" args="(TechnoClass *, HouseClass *, WarheadTypeClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEligibleEMPTarget           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WarheadTypeClass *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is a valid target for EMPs fired by a house. 
<p>
An eligible target is not currently immune to EMPs and the EMP would have an effect.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP will be fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True Target is eligible, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-30 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00308"></a>00308                                                                                                            {
<a name="l00309"></a>00309         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#12fb80c513248acdd3e1e64a13fb91e2" title="Gets whether a Techno is currently immune to EMPs fired by a house.">isCurrentlyEMPImmune</a>(Target, SourceHouse)) {
<a name="l00310"></a>00310                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00311"></a>00311         }
<a name="l00312"></a>00312 
<a name="l00313"></a>00313         <span class="keywordflow">if</span> (!<a class="code" href="class_warhead_type_ext.html#a48823644e4bd1b79a7ef4b917131191" title="Gets whether a Techno can be affected by a warhead fired by a house.">WarheadTypeExt::canWarheadAffectTarget</a>(Target, SourceHouse, Warhead)) {
<a name="l00314"></a>00314                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00315"></a>00315                         Debug::Log(<span class="stringliteral">"[isEligibleEMPTarget] \"%s\" does not affect target.\n"</span>, Warhead-&gt;ID);
<a name="l00316"></a>00316                 }
<a name="l00317"></a>00317                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00318"></a>00318         }
<a name="l00319"></a>00319 
<a name="l00320"></a>00320         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00321"></a>00321 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5871a06d4aaa50bf1b3cc0b6b37936cf"></a><!-- doxytag: member="EMPulse::isEMPImmune" ref="5871a06d4aaa50bf1b3cc0b6b37936cf" args="(TechnoClass *, HouseClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEMPImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is immune to an EMP fired by a house. 
<p>
Target can not be affected by EMPs if it is either immune to EMPs or type immune. It may also have recieved EMP immunity through it's veterancy.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP is fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-02 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00175"></a>00175                                                                         {
<a name="l00176"></a>00176         <span class="comment">// this can be overridden by a flag on the techno.</span>
<a name="l00177"></a>00177         <a class="code" href="class_techno_type_ext_1_1_ext_data.html">TechnoTypeExt::ExtData</a> *pData = <a class="code" href="class_techno_type_ext.html#cc5f01db1b341572a92ad754a7d15c48">TechnoTypeExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Target-&gt;GetTechnoType());
<a name="l00178"></a>00178 
<a name="l00179"></a>00179         <span class="comment">// There is no other way to use (for example) BuildingTypeClass members from</span>
<a name="l00180"></a>00180         <span class="comment">// TechnoTypeClass Initialize to check if this Techno is EMP-prone. Cache the result</span>
<a name="l00181"></a>00181         <span class="comment">// here.</span>
<a name="l00182"></a>00182         <span class="keywordflow">if</span>(!pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#eba1fedd61202a0ec59a03f9a43c79e4">ImmuneToEMPSet</a>.<a class="code" href="class_valueable.html#4f5eae470563f06f257cbc81df24f7a9">Get</a>()) {
<a name="l00183"></a>00183                 pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa458aaee443bf25663f66ab537c0576">ImmuneToEMP</a>.<a class="code" href="class_valueable.html#eb909ed95d6e70f8afa5e609c9725e08">Set</a>(!<a class="code" href="class_e_m_pulse.html#cae411b2800c152fdb7647c912a421e0" title="Gets whether an EMP would have an effect on a TechnoType.">EMPulse::IsTypeEMPProne</a>(Target-&gt;GetTechnoType()));
<a name="l00184"></a>00184                 pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#eba1fedd61202a0ec59a03f9a43c79e4">ImmuneToEMPSet</a>.<a class="code" href="class_valueable.html#eb909ed95d6e70f8afa5e609c9725e08">Set</a>(<span class="keyword">true</span>);
<a name="l00185"></a>00185         }
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#aa458aaee443bf25663f66ab537c0576">ImmuneToEMP</a>.<a class="code" href="class_valueable.html#4f5eae470563f06f257cbc81df24f7a9">Get</a>()) {
<a name="l00188"></a>00188                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00189"></a>00189                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is ImmuneToEMP.\n"</span>, Target-&gt;get_ID());
<a name="l00190"></a>00190                 }
<a name="l00191"></a>00191                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00192"></a>00192         }
<a name="l00193"></a>00193 
<a name="l00194"></a>00194         <span class="comment">// this may be immune because of veteran and elite abilities.</span>
<a name="l00195"></a>00195         <span class="keywordflow">if</span> (Target-&gt;Veterancy.IsElite() &amp;&amp; (pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#2116994c254b89f1ad9f3e6659e18d5a">EliteAbilityEMPIMMUNE</a> || pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#3e84dd16f4eebc772e0d6d849fc589ec">VeteranAbilityEMPIMMUNE</a>)) {
<a name="l00196"></a>00196                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00197"></a>00197                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is immune because it is elite.\n"</span>, Target-&gt;get_ID());
<a name="l00198"></a>00198                 }
<a name="l00199"></a>00199                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00200"></a>00200         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Target-&gt;Veterancy.IsVeteran() &amp;&amp; pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#3e84dd16f4eebc772e0d6d849fc589ec">VeteranAbilityEMPIMMUNE</a>) {
<a name="l00201"></a>00201                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00202"></a>00202                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is immune because it is veteran.\n"</span>, Target-&gt;get_ID());
<a name="l00203"></a>00203                 }
<a name="l00204"></a>00204                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00205"></a>00205         }
<a name="l00206"></a>00206 
<a name="l00207"></a>00207         <span class="comment">// if houses differ, TypeImmune does not count.</span>
<a name="l00208"></a>00208         <span class="keywordflow">if</span> (Target-&gt;Owner == SourceHouse) {
<a name="l00209"></a>00209                 <span class="comment">// ignore if type immune. don't even try.</span>
<a name="l00210"></a>00210                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#42ff43d73b38e829f54e42f5ca5daade" title="Gets whether a Techno is type immune to EMP.">isEMPTypeImmune</a>(Target)) {
<a name="l00211"></a>00211                         <span class="comment">// This unit can fire emps and type immunity</span>
<a name="l00212"></a>00212                         <span class="comment">// grants it to never be affected.</span>
<a name="l00213"></a>00213                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00214"></a>00214                                 Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is TypeImmune.\n"</span>, Target-&gt;get_ID());
<a name="l00215"></a>00215                         }
<a name="l00216"></a>00216                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00217"></a>00217                 }
<a name="l00218"></a>00218         }
<a name="l00219"></a>00219 
<a name="l00220"></a>00220         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00221"></a>00221 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="42ff43d73b38e829f54e42f5ca5daade"></a><!-- doxytag: member="EMPulse::isEMPTypeImmune" ref="42ff43d73b38e829f54e42f5ca5daade" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEMPTypeImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is type immune to EMP. 
<p>
Type immunity does work a little different for EMP weapons than for ordinary projectiles. Target is type immune to EMP if it has a weapon that uses a warhead also having EMP.Duration set. It is irrelevant which Techno fired the EMP.<p>
If Target is elite, only EliteWeapons are used to check for a non-zero EMP.Duration, otherwise only ordinary Weapons are used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno to check EMP type immunity for.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is type immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00136"></a>00136                                                   {
<a name="l00137"></a>00137         <span class="comment">// find an emp weapon.</span>
<a name="l00138"></a>00138         TechnoTypeClass *TT = Target-&gt;GetTechnoType();
<a name="l00139"></a>00139         <span class="keywordflow">if</span> (TT-&gt;TypeImmune) {
<a name="l00140"></a>00140                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 18; ++i) {
<a name="l00141"></a>00141                         WeaponTypeClass *WeaponType = (!Target-&gt;Veterancy.IsElite())
<a name="l00142"></a>00142                                 ? TT-&gt;get_Weapon(i)
<a name="l00143"></a>00143                                 : TT-&gt;get_EliteWeapon(i);
<a name="l00144"></a>00144                         <span class="keywordflow">if</span> (!WeaponType) {
<a name="l00145"></a>00145                                 <span class="keywordflow">continue</span>;
<a name="l00146"></a>00146                         }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                         WarheadTypeClass *WarheadType = WeaponType-&gt;Warhead;
<a name="l00149"></a>00149                         <span class="keywordflow">if</span> (<a class="code" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *pWH = <a class="code" href="class_warhead_type_ext.html#b2eb86c684fe6f15f9f95a9aa171e7dd">WarheadTypeExt::ExtMap</a>.Find(WarheadType)) {
<a name="l00150"></a>00150                                 <span class="keywordflow">if</span> (pWH-&gt;EMP_Duration != 0) {
<a name="l00151"></a>00151                                         <span class="comment">// this unit can fire emps and type immunity</span>
<a name="l00152"></a>00152                                         <span class="comment">// grants it to never be affected.</span>
<a name="l00153"></a>00153                                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00154"></a>00154                                 }
<a name="l00155"></a>00155                         }
<a name="l00156"></a>00156                 }
<a name="l00157"></a>00157         }
<a name="l00158"></a>00158 
<a name="l00159"></a>00159         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00160"></a>00160 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="cae411b2800c152fdb7647c912a421e0"></a><!-- doxytag: member="EMPulse::IsTypeEMPProne" ref="cae411b2800c152fdb7647c912a421e0" args="(TechnoTypeClass *Type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::IsTypeEMPProne           </td>
          <td>(</td>
          <td class="paramtype">TechnoTypeClass *&nbsp;</td>
          <td class="paramname"> <em>Type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether an EMP would have an effect on a TechnoType. 
<p>
Infantry that has Cyborg set is prone to EMP.<p>
Non-Infantry Foots are prone only if they aren't organic.<p>
Buildings with special functions like Radar, SuperWeapon, PowersUnit, Sensors, LaserFencePost, GapGenerator and UndeploysInto are prone. Otherwise a Building is prone if it consumes power and is Powered.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Type</em>&nbsp;</td><td>The TechnoType to get the susceptibility to EMP of.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Type is prone to EMPs, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-30 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00267"></a>00267                                                    {
<a name="l00268"></a>00268         <span class="keywordtype">bool</span> prone = <span class="keyword">true</span>;
<a name="l00269"></a>00269 
<a name="l00270"></a>00270         <span class="comment">// buildings are emp prone if they consume power and need it to function</span>
<a name="l00271"></a>00271         <span class="keywordflow">if</span> (BuildingTypeClass * BuildingType = specific_cast&lt;BuildingTypeClass *&gt;(Type)) {
<a name="l00272"></a>00272                 prone = (BuildingType-&gt;Powered &amp;&amp; (BuildingType-&gt;PowerDrain &gt; 0));
<a name="l00273"></a>00273 
<a name="l00274"></a>00274                 <span class="comment">// may have a special function.</span>
<a name="l00275"></a>00275                 <span class="keywordflow">if</span> (BuildingType-&gt;Radar ||
<a name="l00276"></a>00276                         (BuildingType-&gt;SuperWeapon&gt; -1) || (BuildingType-&gt;SuperWeapon2 &gt; -1)
<a name="l00277"></a>00277                         || BuildingType-&gt;UndeploysInto
<a name="l00278"></a>00278                         || BuildingType-&gt;PowersUnit
<a name="l00279"></a>00279                         || BuildingType-&gt;Sensors
<a name="l00280"></a>00280                         || BuildingType-&gt;LaserFencePost
<a name="l00281"></a>00281                         || BuildingType-&gt;GapGenerator) {
<a name="l00282"></a>00282                                 prone = <span class="keyword">true</span>;
<a name="l00283"></a>00283                 }
<a name="l00284"></a>00284         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InfantryTypeClass * InfantryType = specific_cast&lt;InfantryTypeClass *&gt;(Type)) {
<a name="l00285"></a>00285                 <span class="comment">// affected only if this is a cyborg.</span>
<a name="l00286"></a>00286                 prone = InfantryType-&gt;Cyborg_;
<a name="l00287"></a>00287         } <span class="keywordflow">else</span> {
<a name="l00288"></a>00288                 <span class="comment">// if this is a vessel or vehicle that is organic: no effect.</span>
<a name="l00289"></a>00289                 prone = !Type-&gt;Organic;
<a name="l00290"></a>00290         }
<a name="l00291"></a>00291 
<a name="l00292"></a>00292         <span class="keywordflow">return</span> prone;
<a name="l00293"></a>00293 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e45b8d77bd3cd58bb1bfaf647af2656b"></a><!-- doxytag: member="EMPulse::updateRadarBlackout" ref="e45b8d77bd3cd58bb1bfaf647af2656b" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateRadarBlackout           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the radar outage for the owning player to match the current EMP effect duration. 
<p>
The radar outage duration will be set to the number of frames the current EMP effect lasts. If there is no EMP in effect, the radar is set to come back online.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be a Radar structure.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00411"></a>00411                                                       {
<a name="l00412"></a>00412         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Techno)) {
<a name="l00413"></a>00413                 <span class="keywordflow">if</span> (!Building-&gt;Type-&gt;InvisibleInGame) {
<a name="l00414"></a>00414                         <span class="keywordflow">if</span> (Building-&gt;Type-&gt;Radar) {
<a name="l00415"></a>00415                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00416"></a>00416                                         Debug::Log(<span class="stringliteral">"[updateRadarBlackout] Before: %d, %d\n"</span>,
<a name="l00417"></a>00417                                                         Building-&gt;EMPLockRemaining,
<a name="l00418"></a>00418                                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft);
<a name="l00419"></a>00419                                 }
<a name="l00420"></a>00420                                 <span class="keywordflow">if</span> (Building-&gt;EMPLockRemaining &gt; 0) {
<a name="l00421"></a>00421                                         Building-&gt;Owner-&gt;CreateRadarOutage(Building-&gt;EMPLockRemaining);
<a name="l00422"></a>00422                                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00423"></a>00423                                                 Debug::Log(<span class="stringliteral">"[enableEMPEffect] Radar down for: %d\n"</span>, Building-&gt;EMPLockRemaining);
<a name="l00424"></a>00424                                         }
<a name="l00425"></a>00425                                 } <span class="keywordflow">else</span> {
<a name="l00426"></a>00426                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft = 0;
<a name="l00427"></a>00427                                         Building-&gt;Owner-&gt;RadarBlackout = <span class="keyword">true</span>; <span class="comment">// trigger the radar outage check</span>
<a name="l00428"></a>00428                                 }
<a name="l00429"></a>00429                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00430"></a>00430                                         Debug::Log(<span class="stringliteral">"[updateRadarBlackout] After: %d\n"</span>,
<a name="l00431"></a>00431                                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft);
<a name="l00432"></a>00432                                 }
<a name="l00433"></a>00433                         }
<a name="l00434"></a>00434                 }
<a name="l00435"></a>00435         }
<a name="l00436"></a>00436 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9861f36902003925c8aaea5082f0121b"></a><!-- doxytag: member="EMPulse::updateSlaveManager" ref="9861f36902003925c8aaea5082f0121b" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateSlaveManager           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the SlaveManager to account for the EMP effect. 
<p>
Stops the slaves where they are standing until the EMP effect is over.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be an enslaver.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-07 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00482"></a>00482                                                      {
<a name="l00483"></a>00483         <span class="keywordflow">if</span> (SlaveManagerClass *SM = Techno-&gt;SlaveManager) {
<a name="l00484"></a>00484                 
<a name="l00485"></a>00485                 <span class="keywordflow">if</span> (Techno-&gt;EMPLockRemaining &gt; 0) {
<a name="l00486"></a>00486                         <span class="comment">// pause the timers so spawning and regenerating is deferred.</span>
<a name="l00487"></a>00487                         SM-&gt;RespawnTimer.StartTime = -1;
<a name="l00488"></a>00488                 } <span class="keywordflow">else</span> {
<a name="l00489"></a>00489                         <span class="comment">// resume slaving around.</span>
<a name="l00490"></a>00490                         SM-&gt;RespawnTimer.StartIfEmpty();
<a name="l00491"></a>00491                 }
<a name="l00492"></a>00492         }
<a name="l00493"></a>00493 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="61f0c37d20dc3bc29f34d497b456c239"></a><!-- doxytag: member="EMPulse::UpdateSparkleAnim" ref="61f0c37d20dc3bc29f34d497b456c239" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::UpdateSparkleAnim           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the sparkle animation of Techno. 
<p>
Enables or disables the EMP sparkle animation.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno to update.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-09 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00504"></a>00504                                                     {
<a name="l00505"></a>00505         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Techno);
<a name="l00506"></a>00506         <span class="keywordflow">if</span> (pData) {
<a name="l00507"></a>00507                 <span class="keywordflow">if</span> (Techno-&gt;IsUnderEMP()) {
<a name="l00508"></a>00508                         <span class="keywordflow">if</span> (!pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a> &amp;&amp; RulesClass::Instance-&gt;EMPulseSparkles) {
<a name="l00509"></a>00509                                 GAME_ALLOC(AnimClass, pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>, RulesClass::Instance-&gt;EMPulseSparkles, &amp;Techno-&gt;Location);
<a name="l00510"></a>00510                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>-&gt;SetOwnerObject(Techno);
<a name="l00511"></a>00511                         }
<a name="l00512"></a>00512                 } <span class="keywordflow">else</span> {
<a name="l00513"></a>00513                         <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>) {
<a name="l00514"></a>00514                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>-&gt;RemainingIterations = 0; <span class="comment">// basically "you don't need to show up anymore"</span>
<a name="l00515"></a>00515                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a> = NULL;
<a name="l00516"></a>00516                         }
<a name="l00517"></a>00517                 }
<a name="l00518"></a>00518         }
<a name="l00519"></a>00519 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b8e45e0a1a4ed89481378782b5ef9d7e"></a><!-- doxytag: member="EMPulse::updateSpawnManager" ref="b8e45e0a1a4ed89481378782b5ef9d7e" args="(TechnoClass *, ObjectClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateSpawnManager           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>Source</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the SpawnManager to account for the EMP effect. 
<p>
Defers all regeneration and spawning until after the EMP effect is over. If spawned units are on the go, that is, launching or flying, they are destroyed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be a spawner.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00449"></a>00449                                                                                   {
<a name="l00450"></a>00450         <span class="keywordflow">if</span> (SpawnManagerClass *SM = Techno-&gt;SpawnManager) {
<a name="l00451"></a>00451                 
<a name="l00452"></a>00452                 <span class="keywordflow">if</span> (Techno-&gt;EMPLockRemaining &gt; 0) {
<a name="l00453"></a>00453                         <span class="comment">// crash all spawned units that are visible. else, they'd land somewhere else.</span>
<a name="l00454"></a>00454                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; SM-&gt;SpawnedNodes.Count; ++i) {
<a name="l00455"></a>00455                                 SpawnNode *spawn = SM-&gt;SpawnedNodes.GetItem(i);
<a name="l00456"></a>00456                                 <span class="comment">// kill every spawned unit that is in the air. exempt missiles.</span>
<a name="l00457"></a>00457                                 <span class="keywordflow">if</span>(!spawn-&gt;IsSpawnMissile &amp;&amp; spawn-&gt;Unit &amp;&amp; spawn-&gt;Status &gt;= 0 &amp;&amp; spawn-&gt;Status &lt;= 4) {
<a name="l00458"></a>00458                                         spawn-&gt;Unit-&gt;Crash(Source);
<a name="l00459"></a>00459                                 }
<a name="l00460"></a>00460                         }
<a name="l00461"></a>00461 
<a name="l00462"></a>00462                         <span class="comment">// pause the timers so spawning and regenerating is deferred.</span>
<a name="l00463"></a>00463                         SM-&gt;SpawnTimer.StartTime = -1;
<a name="l00464"></a>00464                         SM-&gt;UnknownTimer.StartTime = -1;
<a name="l00465"></a>00465                 } <span class="keywordflow">else</span> {
<a name="l00466"></a>00466                         <span class="comment">// resume counting.</span>
<a name="l00467"></a>00467                         SM-&gt;SpawnTimer.StartIfEmpty();
<a name="l00468"></a>00468                         SM-&gt;UnknownTimer.StartIfEmpty();
<a name="l00469"></a>00469                 }
<a name="l00470"></a>00470         }
<a name="l00471"></a>00471 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c5be0a3f0350827da617ba594d1cd307"></a><!-- doxytag: member="EMPulse::verbose" ref="c5be0a3f0350827da617ba594d1cd307" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307">EMPulse::verbose</a> = true<code> [static, protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables verbose debug output for some <a class="el" href="class_warhead_type_ext.html">WarheadTypeExt</a> functions. 
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Misc/<a class="el" href="_e_m_pulse_8h.html">EMPulse.h</a><li>Misc/<a class="el" href="_e_m_pulse_8cpp.html">EMPulse.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Wed May 12 23:21:00 2010 for Ares by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
