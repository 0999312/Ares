<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Ares: EMPulse Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<script type="text/javascript">
<!--
function changeDisplayState (e){
  var num=this.id.replace(/[^[0-9]/g,'');
  var button=this.firstChild;
  var sectionDiv=document.getElementById('dynsection'+num);
  if (sectionDiv.style.display=='none'||sectionDiv.style.display==''){
    sectionDiv.style.display='block';
    button.src='open.gif';
  }else{
    sectionDiv.style.display='none';
    button.src='closed.gif';
  }
}
function initDynSections(){
  var divs=document.getElementsByTagName('div');
  var sectionCounter=1;
  for(var i=0;i<divs.length-1;i++){
    if(divs[i].className=='dynheader'&&divs[i+1].className=='dynsection'){
      var header=divs[i];
      var section=divs[i+1];
      var button=header.firstChild;
      if (button!='IMG'){
        divs[i].insertBefore(document.createTextNode(' '),divs[i].firstChild);
        button=document.createElement('img');
        divs[i].insertBefore(button,divs[i].firstChild);
      }
      header.style.cursor='pointer';
      header.onclick=changeDisplayState;
      header.id='dynheader'+sectionCounter;
      button.src='closed.gif';
      section.id='dynsection'+sectionCounter;
      section.style.display='none';
      section.style.marginLeft='14px';
      sectionCounter++;
    }
  }
}
window.onload = initDynSections;
-->
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    <li>
      <form action="search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="classes.html"><span>Class&nbsp;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>EMPulse Class Reference</h1><!-- doxytag: class="EMPulse" --><code>#include &lt;Misc/EMPulse.h&gt;</code>
<p>

<p>
<a href="class_e_m_pulse-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#75940911afe58f6b0f99a26eeef81540">CreateEMPulse</a> (<a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *Warhead, CoordStruct *Target, TechnoClass *Firer)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Paralyses all units using an EMP cellspread weapon.  <a href="#75940911afe58f6b0f99a26eeef81540"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#46041f950a72e7479ba8d47e93937b5a">DisableEMPEffect</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets all properties to re-enable a Techno.  <a href="#46041f950a72e7479ba8d47e93937b5a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#cae411b2800c152fdb7647c912a421e0">IsTypeEMPProne</a> (TechnoTypeClass *Type)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether an EMP would have an effect on a TechnoType.  <a href="#cae411b2800c152fdb7647c912a421e0"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#e2a7d8be2beb4057f72e5aec4f2cdcb1">IsDeactivationAdvisable</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether this Techno should be deactivated right now.  <a href="#e2a7d8be2beb4057f72e5aec4f2cdcb1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239">UpdateSparkleAnim</a> (TechnoClass *Techno)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the sparkle animation of Techno.  <a href="#61f0c37d20dc3bc29f34d497b456c239"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#8bf999e351f0c86e0ae7130ca2d57248">deliverEMPDamage</a> (ObjectClass *, TechnoClass *, <a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deals EMP damage the object.  <a href="#8bf999e351f0c86e0ae7130ca2d57248"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#42ff43d73b38e829f54e42f5ca5daade">isEMPTypeImmune</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is type immune to EMP.  <a href="#42ff43d73b38e829f54e42f5ca5daade"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#5871a06d4aaa50bf1b3cc0b6b37936cf">isEMPImmune</a> (TechnoClass *, HouseClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is immune to an EMP fired by a house.  <a href="#5871a06d4aaa50bf1b3cc0b6b37936cf"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#12fb80c513248acdd3e1e64a13fb91e2">isCurrentlyEMPImmune</a> (TechnoClass *, HouseClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is currently immune to EMPs fired by a house.  <a href="#12fb80c513248acdd3e1e64a13fb91e2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#ba6c1cd17600a649e0c4f282825cd850">isEligibleEMPTarget</a> (TechnoClass *, HouseClass *, WarheadTypeClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets whether a Techno is a valid target for EMPs fired by a house.  <a href="#ba6c1cd17600a649e0c4f282825cd850"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#3ec979d32354b0e4decb6b32eec85eba">getCappedDuration</a> (int, int, int)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Gets the new duration the EMP effect will last.  <a href="#3ec979d32354b0e4decb6b32eec85eba"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b">updateRadarBlackout</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the radar outage for the owning player to match the current EMP effect duration.  <a href="#e45b8d77bd3cd58bb1bfaf647af2656b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e">updateSpawnManager</a> (TechnoClass *, ObjectClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the SpawnManager to account for the EMP effect.  <a href="#b8e45e0a1a4ed89481378782b5ef9d7e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b">updateSlaveManager</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Updates the SlaveManager to account for the EMP effect.  <a href="#9861f36902003925c8aaea5082f0121b"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#8cb96ccf83aa30ecbf474d625f1cf6ef">enableEMPEffect</a> (TechnoClass *, ObjectClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Sets all properties to disable a Techno.  <a href="#8cb96ccf83aa30ecbf474d625f1cf6ef"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#85881f5b68e24bef805079881666bceb">announceAttack</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">If the victim is owned by the human player creates radar events and EVA warnings.  <a href="#85881f5b68e24bef805079881666bceb"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#f4b3b9b8ea4b6259de2b9d7f0c1d0c37">thresholdExceeded</a> (TechnoClass *)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Checks whether a Techno should be considered destroyed.  <a href="#f4b3b9b8ea4b6259de2b9d7f0c1d0c37"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Static Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">static bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307">verbose</a> = true</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Enables verbose debug output for some <a class="el" href="class_warhead_type_ext.html">WarheadTypeExt</a> functions.  <a href="#c5be0a3f0350827da617ba594d1cd307"></a><br></td></tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="85881f5b68e24bef805079881666bceb"></a><!-- doxytag: member="EMPulse::announceAttack" ref="85881f5b68e24bef805079881666bceb" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::announceAttack           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
If the victim is owned by the human player creates radar events and EVA warnings. 
<p>
Creates a radar event and makes EVA tell you so if the Techno is a resource gatherer or harvester. If it is a building that can not be undeployed and counts as BaseNormal a base under attack event is raised.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that has been attacked.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-29 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00619"></a>00619                                                  {
<a name="l00620"></a>00620         <span class="keyword">enum</span> AttackEvents {None = 0, Base = 1, Harvester = 2};
<a name="l00621"></a>00621         AttackEvents rEvent = None;
<a name="l00622"></a>00622 
<a name="l00623"></a>00623         <span class="comment">// find out what event is the most appropriate.</span>
<a name="l00624"></a>00624         <span class="keywordflow">if</span> (Techno &amp;&amp; (Techno-&gt;Owner == HouseClass::Player)) {
<a name="l00625"></a>00625                 <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Techno)) {
<a name="l00626"></a>00626                         <span class="keywordflow">if</span>(Building-&gt;Type-&gt;ResourceGatherer) {
<a name="l00627"></a>00627                                 <span class="comment">// slave miner, for example</span>
<a name="l00628"></a>00628                                 rEvent = Harvester;
<a name="l00629"></a>00629                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!Building-&gt;Type-&gt;Insignificant &amp;&amp; !Building-&gt;Type-&gt;BaseNormal) {
<a name="l00630"></a>00630                                 rEvent = Base;
<a name="l00631"></a>00631                         }
<a name="l00632"></a>00632                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (UnitClass * Unit = specific_cast&lt;UnitClass *&gt;(Techno)) {
<a name="l00633"></a>00633                         <span class="keywordflow">if</span> (Unit-&gt;Type-&gt;Harvester || Unit-&gt;Type-&gt;ResourceGatherer) {
<a name="l00634"></a>00634                                 rEvent = Harvester;
<a name="l00635"></a>00635                         }
<a name="l00636"></a>00636                 }
<a name="l00637"></a>00637         }
<a name="l00638"></a>00638 
<a name="l00639"></a>00639         <span class="comment">// handle the event.</span>
<a name="l00640"></a>00640         <span class="keywordflow">if</span> (rEvent != None) {
<a name="l00641"></a>00641                 CellStruct xy;
<a name="l00642"></a>00642                 Techno-&gt;GetMapCoords(&amp;xy);
<a name="l00643"></a>00643 
<a name="l00644"></a>00644                 <span class="keywordflow">switch</span> (rEvent) {
<a name="l00645"></a>00645                         <span class="keywordflow">case</span> Harvester:
<a name="l00646"></a>00646                                 <span class="keywordflow">if</span> (RadarEventClass::Create(RADAREVENT_OREMINERUNDERATTACK, xy))
<a name="l00647"></a>00647                                         VoxClass::Play(<span class="stringliteral">"EVA_OreMinerUnderAttack"</span>, -1, -1);
<a name="l00648"></a>00648                                 <span class="keywordflow">break</span>;
<a name="l00649"></a>00649                         <span class="keywordflow">case</span> Base:
<a name="l00650"></a>00650                                 HouseClass::Player-&gt;BuildingUnderAttack(specific_cast&lt;BuildingClass *&gt;(Techno));
<a name="l00651"></a>00651                                 <span class="keywordflow">break</span>;
<a name="l00652"></a>00652                 }
<a name="l00653"></a>00653         }
<a name="l00654"></a>00654 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="75940911afe58f6b0f99a26eeef81540"></a><!-- doxytag: member="EMPulse::CreateEMPulse" ref="75940911afe58f6b0f99a26eeef81540" args="(WarheadTypeExt::ExtData *Warhead, CoordStruct *Target, TechnoClass *Firer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::CreateEMPulse           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">CoordStruct *&nbsp;</td>
          <td class="paramname"> <em>Coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Firer</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Paralyses all units using an EMP cellspread weapon. 
<p>
All Technos in the EMPulse's target cells get affected by an EMP and get deactivated temporarily. Their special functions stop working until the EMP ceases. Flying Aircraft crashes.<p>
CellSpread is handled as described in <a href="http://modenc.renegadeprojects.com/CellSpread.">http://modenc.renegadeprojects.com/CellSpread.</a><p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em><a class="el" href="class_e_m_pulse.html">EMPulse</a></em>&nbsp;</td><td>The electromagnetic pulse to create. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Coords</em>&nbsp;</td><td>The location the projectile detonated. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Firer</em>&nbsp;</td><td>The Techno that fired the pulse.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-20 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00025"></a>00025                                                                                                     {
<a name="l00026"></a>00026         <span class="keywordflow">if</span> (!Warhead) {
<a name="l00027"></a>00027                 <a class="code" href="class_debug.html#4dcfff56d6e69bd62771feadb91014de">Debug::DevLog</a>(<a class="code" href="class_debug.html#38f58dd0c1bec9042ead4a8eea1f3db184c6ea9e411b9a465c18af311547f156">Debug::Error</a>, <span class="stringliteral">"Trying to CreateEMPulse() with Warhead pointing to NULL. Funny.\n"</span>);
<a name="l00028"></a>00028                 <span class="keywordflow">return</span>;
<a name="l00029"></a>00029         }
<a name="l00030"></a>00030 
<a name="l00031"></a>00031         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00032"></a>00032                 Debug::Log(<span class="stringliteral">"[CreateEMPulse] Duration: %d, Cap: %d\n"</span>, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#94e6b628222742c7b45bcee95aeb04be">EMP_Duration</a>, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#fe4a4a59145d61135b4e5e4efd8b4127">EMP_Cap</a>);
<a name="l00033"></a>00033         }
<a name="l00034"></a>00034 
<a name="l00035"></a>00035         <span class="comment">// set of possibly affected objects. every object can be here only once.</span>
<a name="l00036"></a>00036         std::set&lt;TechnoClass*&gt; *<span class="keyword">set</span> = <span class="keyword">new</span> std::set&lt;TechnoClass*&gt;();
<a name="l00037"></a>00037 
<a name="l00038"></a>00038         <span class="comment">// the quick way. only look at stuff residing on the very cells we are affecting.</span>
<a name="l00039"></a>00039         CellStruct cellCoords = MapClass::Instance-&gt;GetCellAt(Coords)-&gt;MapCoords;
<a name="l00040"></a>00040         <span class="keywordtype">int</span> countCells = CellSpread::NumCells((<span class="keywordtype">int</span>)(Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;CellSpread + 0.99));
<a name="l00041"></a>00041         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; countCells; ++i) {
<a name="l00042"></a>00042                 CellStruct tmpCell = CellSpread::GetCell(i);
<a name="l00043"></a>00043                 tmpCell += cellCoords;
<a name="l00044"></a>00044                 CellClass *c = MapClass::Instance-&gt;GetCellAt(&amp;tmpCell);
<a name="l00045"></a>00045                 <span class="keywordflow">for</span> (ObjectClass *curObj = c-&gt;GetContent(); curObj; curObj = curObj-&gt;NextObject) {
<a name="l00046"></a>00046                         <span class="keywordflow">if</span>(TechnoClass *Techno = generic_cast&lt;TechnoClass*&gt;(curObj)) {
<a name="l00047"></a>00047                                 <span class="keyword">set</span>-&gt;insert(Techno);
<a name="l00048"></a>00048                         }
<a name="l00049"></a>00049                 }
<a name="l00050"></a>00050         }
<a name="l00051"></a>00051 
<a name="l00052"></a>00052         <span class="comment">// the not quite so fast way. skip everything not in the air.</span>
<a name="l00053"></a>00053         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;TechnoClass::Array-&gt;Count; ++i) {
<a name="l00054"></a>00054                 TechnoClass *Techno = TechnoClass::Array-&gt;GetItem(i);
<a name="l00055"></a>00055                 <span class="keywordflow">if</span> (Techno-&gt;IsInAir()) {
<a name="l00056"></a>00056                         <span class="keywordflow">if</span>(Techno-&gt;Location.DistanceFrom(*Coords) &lt;= Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>-&gt;CellSpread * 256) {
<a name="l00057"></a>00057                                 <span class="keyword">set</span>-&gt;insert(Techno);
<a name="l00058"></a>00058                         }
<a name="l00059"></a>00059                 }
<a name="l00060"></a>00060         }
<a name="l00061"></a>00061 
<a name="l00062"></a>00062         <span class="comment">// cause EMP damage on every object</span>
<a name="l00063"></a>00063         <span class="keywordflow">for</span>(std::set&lt;TechnoClass*&gt;::iterator iterator = set-&gt;begin(); iterator != <span class="keyword">set</span>-&gt;end(); iterator++) {
<a name="l00064"></a>00064                 TechnoClass *Techno = *iterator;
<a name="l00065"></a>00065 
<a name="l00066"></a>00066                 <span class="comment">// ignore buildings that are not visible, like ambient light posts</span>
<a name="l00067"></a>00067                 <span class="keywordflow">if</span>(BuildingTypeClass *BT = specific_cast&lt;BuildingTypeClass*&gt;(Techno-&gt;GetTechnoType())) {
<a name="l00068"></a>00068                         <span class="keywordflow">if</span>(BT-&gt;InvisibleInGame) {
<a name="l00069"></a>00069                                 <span class="keywordflow">continue</span>;
<a name="l00070"></a>00070                         }
<a name="l00071"></a>00071                 }
<a name="l00072"></a>00072 
<a name="l00073"></a>00073                 <span class="comment">// get distance from impact site</span>
<a name="l00074"></a>00074                 CoordStruct target;
<a name="l00075"></a>00075                 Techno-&gt;GetCoords(&amp;target);
<a name="l00076"></a>00076                 <span class="keywordtype">double</span> dist = target.DistanceFrom(*Coords);
<a name="l00077"></a>00077 
<a name="l00078"></a>00078                 <span class="comment">// reduce the distance for flying aircraft</span>
<a name="l00079"></a>00079                 <span class="keywordflow">if</span>((Techno-&gt;WhatAmI() == abs_Aircraft) &amp;&amp; Techno-&gt;IsInAir()) {
<a name="l00080"></a>00080                         dist *= 0.5;
<a name="l00081"></a>00081                 }
<a name="l00082"></a>00082 
<a name="l00083"></a>00083                 <span class="comment">// measure distance and blow it</span>
<a name="l00084"></a>00084                 <span class="keywordflow">if</span>(dist &lt;= Warhead-&gt;AttachedToObject-&gt;CellSpread * 256) {
<a name="l00085"></a>00085                         <a class="code" href="class_e_m_pulse.html#8bf999e351f0c86e0ae7130ca2d57248" title="Deals EMP damage the object.">deliverEMPDamage</a>(Techno, Firer, Warhead);
<a name="l00086"></a>00086                 }
<a name="l00087"></a>00087         }
<a name="l00088"></a>00088 
<a name="l00089"></a>00089         <span class="comment">// tidy up</span>
<a name="l00090"></a>00090         <span class="keyword">set</span>-&gt;clear();
<a name="l00091"></a>00091         <span class="keyword">delete</span> <span class="keyword">set</span>;
<a name="l00092"></a>00092 
<a name="l00093"></a>00093         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00094"></a>00094                 Debug::Log(<span class="stringliteral">"[CreateEMPulse] Done.\n"</span>);
<a name="l00095"></a>00095         }
<a name="l00096"></a>00096 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8bf999e351f0c86e0ae7130ca2d57248"></a><!-- doxytag: member="EMPulse::deliverEMPDamage" ref="8bf999e351f0c86e0ae7130ca2d57248" args="(ObjectClass *, TechnoClass *, WarheadTypeExt::ExtData *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::deliverEMPDamage           </td>
          <td>(</td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Firer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Deals EMP damage the object. 
<p>
Applies, removes or alters the EMP effect on a given unit.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>object</em>&nbsp;</td><td>The Techno that should get affected by EMP.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00107"></a>00107                                                                                                       {
<a name="l00108"></a>00108         <span class="comment">// fill the gaps</span>
<a name="l00109"></a>00109         HouseClass *pHouse = (Firer ? Firer-&gt;Owner : NULL);
<a name="l00110"></a>00110         
<a name="l00111"></a>00111         <span class="keywordflow">if</span> (TechnoClass * curTechno = generic_cast&lt;TechnoClass *&gt; (<span class="keywordtype">object</span>)) {
<a name="l00112"></a>00112                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00113"></a>00113                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 1: %s =&gt; %s\n"</span>,
<a name="l00114"></a>00114                                         (Firer ? Firer-&gt;get_ID() : NULL),
<a name="l00115"></a>00115                                         curTechno-&gt;get_ID());
<a name="l00116"></a>00116                 }
<a name="l00117"></a>00117 
<a name="l00118"></a>00118                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#ba6c1cd17600a649e0c4f282825cd850" title="Gets whether a Techno is a valid target for EMPs fired by a house.">isEligibleEMPTarget</a>(curTechno, pHouse, Warhead-&gt;<a class="code" href="class_extension.html#72742b36a0db81d6697da473dfe8281d">AttachedToObject</a>)) {
<a name="l00119"></a>00119                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00120"></a>00120                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 2: %s\n"</span>,
<a name="l00121"></a>00121                                                 curTechno-&gt;get_ID());
<a name="l00122"></a>00122                         }
<a name="l00123"></a>00123 
<a name="l00124"></a>00124                         <span class="comment">// respect verses</span>
<a name="l00125"></a>00125                         <span class="keywordtype">int</span> Duration = Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#94e6b628222742c7b45bcee95aeb04be">EMP_Duration</a>;
<a name="l00126"></a>00126                         <span class="keywordflow">if</span>(<span class="keyword">false</span>) {
<a name="l00127"></a>00127                                 Duration = (int)(Duration * Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#a98c782be341b4956d26eb59a1ea553b">Verses</a>[curTechno-&gt;GetTechnoType()-&gt;Armor].Verses);
<a name="l00128"></a>00128                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(abs(Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#a98c782be341b4956d26eb59a1ea553b">Verses</a>[curTechno-&gt;GetTechnoType()-&gt;Armor].Verses) &lt; 0.001) {
<a name="l00129"></a>00129                                 <span class="keywordflow">return</span>;
<a name="l00130"></a>00130                         }
<a name="l00131"></a>00131 
<a name="l00132"></a>00132                         <span class="comment">// get the new capped value</span>
<a name="l00133"></a>00133                         <span class="keywordtype">int</span> oldValue = curTechno-&gt;EMPLockRemaining;
<a name="l00134"></a>00134                         <span class="keywordtype">int</span> newValue = <a class="code" href="class_e_m_pulse.html#3ec979d32354b0e4decb6b32eec85eba" title="Gets the new duration the EMP effect will last.">getCappedDuration</a>(oldValue, Duration, Warhead-&gt;<a class="code" href="class_warhead_type_ext_1_1_ext_data.html#fe4a4a59145d61135b4e5e4efd8b4127">EMP_Cap</a>);
<a name="l00135"></a>00135 
<a name="l00136"></a>00136                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00137"></a>00137                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 3: %d\n"</span>,
<a name="l00138"></a>00138                                                 newValue);
<a name="l00139"></a>00139                         }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141                         <span class="comment">// can not be less than zero</span>
<a name="l00142"></a>00142                         curTechno-&gt;EMPLockRemaining = max(0, newValue);
<a name="l00143"></a>00143                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00144"></a>00144                                 Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 4: %d\n"</span>,
<a name="l00145"></a>00145                                                 newValue);
<a name="l00146"></a>00146                         }
<a name="l00147"></a>00147 
<a name="l00148"></a>00148                         <span class="comment">// newly de-paralyzed</span>
<a name="l00149"></a>00149                         <span class="keywordflow">if</span> ((oldValue &gt; 0) &amp;&amp; (curTechno-&gt;EMPLockRemaining &lt;= 0)) {
<a name="l00150"></a>00150                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00151"></a>00151                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5a\n"</span>);
<a name="l00152"></a>00152                                 }
<a name="l00153"></a>00153                                 <a class="code" href="class_e_m_pulse.html#46041f950a72e7479ba8d47e93937b5a" title="Sets all properties to re-enable a Techno.">DisableEMPEffect</a>(curTechno);
<a name="l00154"></a>00154                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((oldValue &lt;= 0) &amp;&amp; (curTechno-&gt;EMPLockRemaining &gt; 0)) {
<a name="l00155"></a>00155                                 <span class="comment">// newly paralyzed unit</span>
<a name="l00156"></a>00156                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00157"></a>00157                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5b\n"</span>);
<a name="l00158"></a>00158                                 }
<a name="l00159"></a>00159                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#8cb96ccf83aa30ecbf474d625f1cf6ef" title="Sets all properties to disable a Techno.">enableEMPEffect</a>(curTechno, Firer)) {
<a name="l00160"></a>00160                                         <span class="keywordflow">return</span>;
<a name="l00161"></a>00161                                 }
<a name="l00162"></a>00162                         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (oldValue != newValue) {
<a name="l00163"></a>00163                                 <span class="comment">// At least update the radar, if this is one.</span>
<a name="l00164"></a>00164                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00165"></a>00165                                         Debug::Log(<span class="stringliteral">"[deliverEMPDamage] Step 5c\n"</span>);
<a name="l00166"></a>00166                                 }
<a name="l00167"></a>00167                                 <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(curTechno);
<a name="l00168"></a>00168                         }
<a name="l00169"></a>00169 
<a name="l00170"></a>00170                         <span class="comment">// is techno destroyed by EMP?</span>
<a name="l00171"></a>00171                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#f4b3b9b8ea4b6259de2b9d7f0c1d0c37" title="Checks whether a Techno should be considered destroyed.">thresholdExceeded</a>(curTechno)) {
<a name="l00172"></a>00172                                 curTechno-&gt;Destroyed(Firer);
<a name="l00173"></a>00173                                 <span class="keywordflow">if</span> (curTechno-&gt;IsInAir()) {
<a name="l00174"></a>00174                                         curTechno-&gt;Crash(Firer);
<a name="l00175"></a>00175                                 } <span class="keywordflow">else</span> {
<a name="l00176"></a>00176                                         curTechno-&gt;Destroy();
<a name="l00177"></a>00177                                         curTechno-&gt;Remove();
<a name="l00178"></a>00178                                         curTechno-&gt;UnInit();
<a name="l00179"></a>00179                                 }
<a name="l00180"></a>00180                                 
<a name="l00181"></a>00181                                 <span class="comment">// play unit voice</span>
<a name="l00182"></a>00182                                 <span class="keywordflow">if</span> (curTechno-&gt;Owner == HouseClass::Player) {
<a name="l00183"></a>00183                                         TechnoTypeClass *TT = curTechno-&gt;GetTechnoType();
<a name="l00184"></a>00184                                         <span class="keywordflow">if</span> (curTechno-&gt;IsInAir()) {
<a name="l00185"></a>00185                                                 VocClass::PlayAt(TT-&gt;VoiceCrashing, &amp;curTechno-&gt;Location, NULL);
<a name="l00186"></a>00186                                         }
<a name="l00187"></a>00187 
<a name="l00188"></a>00188                                         <span class="keywordflow">if</span> (TT-&gt;VoiceDie.Count) {
<a name="l00189"></a>00189                                                 VocClass::PlayAt(TT-&gt;VoiceDie[rand() % TT-&gt;VoiceDie.Count], &amp;curTechno-&gt;Location, NULL);
<a name="l00190"></a>00190                                         }
<a name="l00191"></a>00191 
<a name="l00192"></a>00192                                         <span class="keywordflow">if</span> (TT-&gt;DieSound.Count) {
<a name="l00193"></a>00193                                                 VocClass::PlayAt(TT-&gt;DieSound[rand() % TT-&gt;DieSound.Count], &amp;curTechno-&gt;Location, NULL);
<a name="l00194"></a>00194                                         }
<a name="l00195"></a>00195                                 }
<a name="l00196"></a>00196                         }
<a name="l00197"></a>00197                 }
<a name="l00198"></a>00198         }
<a name="l00199"></a>00199 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="46041f950a72e7479ba8d47e93937b5a"></a><!-- doxytag: member="EMPulse::DisableEMPEffect" ref="46041f950a72e7479ba8d47e93937b5a" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::DisableEMPEffect           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Victim</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets all properties to re-enable a Techno. 
<p>
Reactivates the Techno. The EMP sparkle animation is stopped.<p>
Radars come back online. Spawners are allowed to resume their work.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Victim</em>&nbsp;</td><td>The Techno that shall have its EMP effects removed.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00768"></a>00768                                                    {
<a name="l00769"></a>00769         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Victim);
<a name="l00770"></a>00770         <span class="keywordtype">bool</span> HasPower = <span class="keyword">true</span>;
<a name="l00771"></a>00771 
<a name="l00772"></a>00772         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Victim)) {
<a name="l00773"></a>00773                 HasPower = Building-&gt;HasPower &amp;&amp; !(Building-&gt;Owner-&gt;PowerDrain &gt; Building-&gt;Owner-&gt;PowerOutput) ;
<a name="l00774"></a>00774 
<a name="l00775"></a>00775                 <span class="keywordflow">if</span> (!Building-&gt;Type-&gt;InvisibleInGame) {
<a name="l00776"></a>00776                         <span class="keywordflow">if</span> (HasPower) {
<a name="l00777"></a>00777                                 Building-&gt;EnableStuff();
<a name="l00778"></a>00778                         }
<a name="l00779"></a>00779                         <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(Building);
<a name="l00780"></a>00780                 }
<a name="l00781"></a>00781         }
<a name="l00782"></a>00782 
<a name="l00783"></a>00783         Victim-&gt;Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
<a name="l00784"></a>00784         Victim-&gt;Owner-&gt;PowerBlackout = <span class="keyword">true</span>;
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <span class="keywordflow">if</span> (Victim-&gt;Deactivated &amp;&amp; HasPower) {
<a name="l00787"></a>00787                 Victim-&gt;Reactivate();
<a name="l00788"></a>00788         }
<a name="l00789"></a>00789 
<a name="l00790"></a>00790         <span class="comment">// allow to spawn units again.</span>
<a name="l00791"></a>00791         <a class="code" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e" title="Updates the SpawnManager to account for the EMP effect.">updateSpawnManager</a>(Victim);
<a name="l00792"></a>00792         <a class="code" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b" title="Updates the SlaveManager to account for the EMP effect.">updateSlaveManager</a>(Victim);
<a name="l00793"></a>00793 
<a name="l00794"></a>00794         <span class="comment">// update the animation</span>
<a name="l00795"></a>00795         <a class="code" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239" title="Updates the sparkle animation of Techno.">UpdateSparkleAnim</a>(Victim);
<a name="l00796"></a>00796 
<a name="l00797"></a>00797         <span class="comment">// get harvesters back to work.</span>
<a name="l00798"></a>00798         <span class="keywordflow">if</span> (UnitClass * Unit = specific_cast&lt;UnitClass *&gt;(Victim)) {
<a name="l00799"></a>00799                 <span class="keywordflow">if</span> (Unit-&gt;Type-&gt;Harvester || Unit-&gt;Type-&gt;ResourceGatherer) {
<a name="l00800"></a>00800                         Unit-&gt;QueueMission(pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#9b5284c0b77edaefb5b295f6a3be9ef5">EMPLastMission</a>, <span class="keyword">true</span>);
<a name="l00801"></a>00801                 }
<a name="l00802"></a>00802         }
<a name="l00803"></a>00803 }</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="8cb96ccf83aa30ecbf474d625f1cf6ef"></a><!-- doxytag: member="EMPulse::enableEMPEffect" ref="8cb96ccf83aa30ecbf474d625f1cf6ef" args="(TechnoClass *, ObjectClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::enableEMPEffect           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Victim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>Source</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Sets all properties to disable a Techno. 
<p>
Disables Buildings and crashes flying Aircrafts. Foots get deactivated. An EMP sparkle animation is created and played until the EMP effect ceases.<p>
Contains special handling to create a radar outage equalling the length of the EMP effect, if Victim is a Building with Radar capabilities.<p>
If Victim mind controls any units, they are freed. Spawned units are killed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Victim</em>&nbsp;</td><td>The Techno that is under EMP effect. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Source</em>&nbsp;</td><td>The house to credit kills to.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Victim has been destroyed by the EMP effect, False otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-21 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00705"></a>00705                                                                         {
<a name="l00706"></a>00706         Victim-&gt;Owner-&gt;ShouldRecheckTechTree = <span class="keyword">true</span>;
<a name="l00707"></a>00707         Victim-&gt;Owner-&gt;PowerBlackout = <span class="keyword">true</span>;
<a name="l00708"></a>00708 
<a name="l00709"></a>00709         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Victim)) {
<a name="l00710"></a>00710                 Building-&gt;DisableStuff();
<a name="l00711"></a>00711                 <a class="code" href="class_e_m_pulse.html#e45b8d77bd3cd58bb1bfaf647af2656b" title="Updates the radar outage for the owning player to match the current EMP effect duration...">updateRadarBlackout</a>(Building);
<a name="l00712"></a>00712         } <span class="keywordflow">else</span> {
<a name="l00713"></a>00713                 <span class="keywordflow">if</span> (AircraftClass * Aircraft = specific_cast&lt;AircraftClass *&gt;(Victim)) {
<a name="l00714"></a>00714                         <span class="comment">// crash flying aircraft</span>
<a name="l00715"></a>00715                         <span class="keywordflow">if</span> (Aircraft-&gt;IsInAir()) {
<a name="l00716"></a>00716                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00717"></a>00717                                         Debug::Log(<span class="stringliteral">"[enableEMPEffect] Plane crash: %s\n"</span>, Aircraft-&gt;get_ID());
<a name="l00718"></a>00718                                 }
<a name="l00719"></a>00719                                 <span class="keywordflow">if</span> (Victim-&gt;Owner == HouseClass::Player) {
<a name="l00720"></a>00720                                         VocClass::PlayAt(Aircraft-&gt;Type-&gt;VoiceCrashing, &amp;Aircraft-&gt;Location, NULL);
<a name="l00721"></a>00721                                 }
<a name="l00722"></a>00722                                 Aircraft-&gt;Crash(Source);
<a name="l00723"></a>00723                                 Aircraft-&gt;Destroyed(Source);
<a name="l00724"></a>00724                                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00725"></a>00725                         }
<a name="l00726"></a>00726                 }
<a name="l00727"></a>00727         }
<a name="l00728"></a>00728 
<a name="l00729"></a>00729         <span class="comment">// cache the last mission this thing did</span>
<a name="l00730"></a>00730         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Victim);
<a name="l00731"></a>00731         pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#9b5284c0b77edaefb5b295f6a3be9ef5">EMPLastMission</a> = Victim-&gt;CurrentMission;
<a name="l00732"></a>00732 
<a name="l00733"></a>00733         <span class="comment">// deactivate and sparkle.</span>
<a name="l00734"></a>00734         <span class="keywordflow">if</span> (!Victim-&gt;Deactivated &amp;&amp; <a class="code" href="class_e_m_pulse.html#e2a7d8be2beb4057f72e5aec4f2cdcb1" title="Gets whether this Techno should be deactivated right now.">IsDeactivationAdvisable</a>(Victim)) {
<a name="l00735"></a>00735                 Victim-&gt;Deactivate();
<a name="l00736"></a>00736         }
<a name="l00737"></a>00737 
<a name="l00738"></a>00738         <span class="comment">// release all captured units.</span>
<a name="l00739"></a>00739         <span class="keywordflow">if</span> (Victim-&gt;CaptureManager) {
<a name="l00740"></a>00740                 Victim-&gt;CaptureManager-&gt;FreeAll();
<a name="l00741"></a>00741         }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743         <span class="comment">// update managers.</span>
<a name="l00744"></a>00744         <a class="code" href="class_e_m_pulse.html#b8e45e0a1a4ed89481378782b5ef9d7e" title="Updates the SpawnManager to account for the EMP effect.">updateSpawnManager</a>(Victim, Source);
<a name="l00745"></a>00745         <a class="code" href="class_e_m_pulse.html#9861f36902003925c8aaea5082f0121b" title="Updates the SlaveManager to account for the EMP effect.">updateSlaveManager</a>(Victim);
<a name="l00746"></a>00746 
<a name="l00747"></a>00747         <span class="comment">// set the sparkle animation.</span>
<a name="l00748"></a>00748         <a class="code" href="class_e_m_pulse.html#61f0c37d20dc3bc29f34d497b456c239" title="Updates the sparkle animation of Techno.">UpdateSparkleAnim</a>(Victim);
<a name="l00749"></a>00749 
<a name="l00750"></a>00750         <span class="comment">// warn the player</span>
<a name="l00751"></a>00751         <a class="code" href="class_e_m_pulse.html#85881f5b68e24bef805079881666bceb" title="If the victim is owned by the human player creates radar events and EVA warnings...">announceAttack</a>(Victim);
<a name="l00752"></a>00752 
<a name="l00753"></a>00753         <span class="comment">// the unit still lives.</span>
<a name="l00754"></a>00754         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00755"></a>00755 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="3ec979d32354b0e4decb6b32eec85eba"></a><!-- doxytag: member="EMPulse::getCappedDuration" ref="3ec979d32354b0e4decb6b32eec85eba" args="(int, int, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int EMPulse::getCappedDuration           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>CurrentValue</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>Cap</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets the new duration the EMP effect will last. 
<p>
The new EMP lock frames count is calculated the following way:<p>
If Duration is positive it will inflict EMP damage. If Cap is larger than zero, the maximum amount of frames will be defined by Cap. If the current value already is larger than that, in will not be reduced. If Cap is zero, then the duration can add up infinitely. If Cap is less than zero, duration will be set to Duration, if the current value is not higher already.<p>
If Duration is negative, the EMP effect will be reduced. A negative Cap reduces the current value by Duration. A positive or zero Cap will do the same, but additionally shorten it to Cap if the result would be higher than that. Thus, a Cap of zero removes the current EMP effect altogether.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>CurrentValue</em>&nbsp;</td><td>The Technos current remaining time. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Duration</em>&nbsp;</td><td>The duration the EMP uses. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>Cap</em>&nbsp;</td><td>The maximum Duration this EMP can cause.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>The new EMP lock frames count.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00464"></a>00464                                                                       {
<a name="l00465"></a>00465         <span class="comment">// Usually, the new duration is just added.</span>
<a name="l00466"></a>00466         <span class="keywordtype">int</span> ProposedDuration = CurrentValue + Duration;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         <span class="keywordflow">if</span> (Duration &gt; 0) {
<a name="l00469"></a>00469                 <span class="comment">// Positive damage.</span>
<a name="l00470"></a>00470                 <span class="keywordflow">if</span> (Cap &lt; 0) {
<a name="l00471"></a>00471                         <span class="comment">// Do not stack. Use the maximum value.</span>
<a name="l00472"></a>00472                         <span class="keywordflow">return</span> max(Duration, CurrentValue);
<a name="l00473"></a>00473                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Cap &gt; 0) {
<a name="l00474"></a>00474                         <span class="comment">// Cap the duration.</span>
<a name="l00475"></a>00475                         <span class="keywordtype">int</span> cappedValue = min(ProposedDuration, Cap);
<a name="l00476"></a>00476                         <span class="keywordflow">return</span> max(CurrentValue, cappedValue);
<a name="l00477"></a>00477                 } <span class="keywordflow">else</span> {
<a name="l00478"></a>00478                         <span class="comment">// There is no cap. Allow the duration to stack up.</span>
<a name="l00479"></a>00479                         <span class="keywordflow">return</span> ProposedDuration;
<a name="l00480"></a>00480                 }
<a name="l00481"></a>00481         } <span class="keywordflow">else</span> {
<a name="l00482"></a>00482                 <span class="comment">// Negative damage.</span>
<a name="l00483"></a>00483                 <span class="keywordflow">return</span> (Cap &lt; 0 ? ProposedDuration : min(ProposedDuration, Cap));
<a name="l00484"></a>00484         }
<a name="l00485"></a>00485 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="12fb80c513248acdd3e1e64a13fb91e2"></a><!-- doxytag: member="EMPulse::isCurrentlyEMPImmune" ref="12fb80c513248acdd3e1e64a13fb91e2" args="(TechnoClass *, HouseClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isCurrentlyEMPImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is currently immune to EMPs fired by a house. 
<p>
Target may not be immune to EMP but its current status still prevents it from being affected by them.<p>
Currently, EMPs can be temporarily averted if Target is under the influence of the Iron Curtain or it is attacked by a Temporal warhead.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP is fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-26 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00321"></a>00321                                                                                  {
<a name="l00322"></a>00322         <span class="comment">// objects currently doing some time travel are exempt</span>
<a name="l00323"></a>00323         <span class="keywordflow">if</span> (Target-&gt;BeingWarpedOut) {
<a name="l00324"></a>00324                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00325"></a>00325         }
<a name="l00326"></a>00326 
<a name="l00327"></a>00327         <span class="comment">// iron curtained objects can not be affected by EMPs</span>
<a name="l00328"></a>00328         <span class="keywordflow">if</span> (Target-&gt;IsIronCurtained()) {
<a name="l00329"></a>00329                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00330"></a>00330         }
<a name="l00331"></a>00331 
<a name="l00332"></a>00332         <span class="comment">// the current status does allow this target to</span>
<a name="l00333"></a>00333         <span class="comment">// be affected by EMPs. It may be immune, though.</span>
<a name="l00334"></a>00334         <span class="keywordflow">return</span> <a class="code" href="class_e_m_pulse.html#5871a06d4aaa50bf1b3cc0b6b37936cf" title="Gets whether a Techno is immune to an EMP fired by a house.">isEMPImmune</a>(Target, SourceHouse);
<a name="l00335"></a>00335 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e2a7d8be2beb4057f72e5aec4f2cdcb1"></a><!-- doxytag: member="EMPulse::IsDeactivationAdvisable" ref="e2a7d8be2beb4057f72e5aec4f2cdcb1" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::IsDeactivationAdvisable           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether this Techno should be deactivated right now. 
<p>
Objects that are currently deploying, constructing, or selling should not be deactivated.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno to be deactivated.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target should be deactivated, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-09 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00422"></a>00422                                                           {
<a name="l00423"></a>00423         <span class="keywordflow">switch</span>(Target-&gt;CurrentMission)
<a name="l00424"></a>00424         {
<a name="l00425"></a>00425         <span class="keywordflow">case</span> mission_Selling:
<a name="l00426"></a>00426         <span class="keywordflow">case</span> mission_Construction:
<a name="l00427"></a>00427         <span class="keywordflow">case</span> mission_Unload:
<a name="l00428"></a>00428                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00429"></a>00429                         Debug::Log(<span class="stringliteral">"[IsDeactivationAdvisable] %s should not be disabled. Mission: %d\n"</span>, Target-&gt;get_ID(), Target-&gt;CurrentMission);
<a name="l00430"></a>00430                 }
<a name="l00431"></a>00431                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00432"></a>00432         }
<a name="l00433"></a>00433 
<a name="l00434"></a>00434         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">EMPulse::verbose</a>) {
<a name="l00435"></a>00435                 Debug::Log(<span class="stringliteral">"[IsDeactivationAdvisable] %s should be disabled. Mission: %d\n"</span>, Target-&gt;get_ID(), Target-&gt;CurrentMission);
<a name="l00436"></a>00436         }
<a name="l00437"></a>00437         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00438"></a>00438 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="ba6c1cd17600a649e0c4f282825cd850"></a><!-- doxytag: member="EMPulse::isEligibleEMPTarget" ref="ba6c1cd17600a649e0c4f282825cd850" args="(TechnoClass *, HouseClass *, WarheadTypeClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEligibleEMPTarget           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">WarheadTypeClass *&nbsp;</td>
          <td class="paramname"> <em>Warhead</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is a valid target for EMPs fired by a house. 
<p>
An eligible target is not currently immune to EMPs and the EMP would have an effect.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP will be fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True Target is eligible, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-30 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00395"></a>00395                                                                                                            {
<a name="l00396"></a>00396         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#12fb80c513248acdd3e1e64a13fb91e2" title="Gets whether a Techno is currently immune to EMPs fired by a house.">isCurrentlyEMPImmune</a>(Target, SourceHouse)) {
<a name="l00397"></a>00397                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00398"></a>00398         }
<a name="l00399"></a>00399 
<a name="l00400"></a>00400         <span class="keywordflow">if</span> (!<a class="code" href="class_warhead_type_ext.html#a48823644e4bd1b79a7ef4b917131191" title="Gets whether a Techno can be affected by a warhead fired by a house.">WarheadTypeExt::canWarheadAffectTarget</a>(Target, SourceHouse, Warhead)) {
<a name="l00401"></a>00401                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00402"></a>00402                         Debug::Log(<span class="stringliteral">"[isEligibleEMPTarget] \"%s\" does not affect target.\n"</span>, Warhead-&gt;ID);
<a name="l00403"></a>00403                 }
<a name="l00404"></a>00404                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00405"></a>00405         }
<a name="l00406"></a>00406 
<a name="l00407"></a>00407         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00408"></a>00408 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="5871a06d4aaa50bf1b3cc0b6b37936cf"></a><!-- doxytag: member="EMPulse::isEMPImmune" ref="5871a06d4aaa50bf1b3cc0b6b37936cf" args="(TechnoClass *, HouseClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEMPImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">HouseClass *&nbsp;</td>
          <td class="paramname"> <em>SourceHouse</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is immune to an EMP fired by a house. 
<p>
Target can not be affected by EMPs if it is either immune to EMPs or type immune. It may also have recieved EMP immunity through it's veterancy.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno the EMP is fired at. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>SourceHouse</em>&nbsp;</td><td>The house that fired the EMP.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-02 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00257"></a>00257                                                                         {
<a name="l00258"></a>00258         <span class="comment">// this can be overridden by a flag on the techno.</span>
<a name="l00259"></a>00259         <a class="code" href="class_techno_type_ext_1_1_ext_data.html">TechnoTypeExt::ExtData</a> *pData = <a class="code" href="class_techno_type_ext.html#cc5f01db1b341572a92ad754a7d15c48">TechnoTypeExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Target-&gt;GetTechnoType());
<a name="l00260"></a>00260 
<a name="l00261"></a>00261         <span class="comment">// There is no other way to use (for example) BuildingTypeClass members from</span>
<a name="l00262"></a>00262         <span class="comment">// TechnoTypeClass Initialize to check if this Techno is EMP-prone. Cache the result</span>
<a name="l00263"></a>00263         <span class="comment">// here.</span>
<a name="l00264"></a>00264         <span class="keywordflow">if</span>(!pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#b5d24ee2a760bfd6da810dee4610dd31">ImmuneToEMPSet</a>) {
<a name="l00265"></a>00265                 pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#7313727d1b8e4c0f6b4d3a60150215e7">ImmuneToEMP</a> = !<a class="code" href="class_e_m_pulse.html#cae411b2800c152fdb7647c912a421e0" title="Gets whether an EMP would have an effect on a TechnoType.">EMPulse::IsTypeEMPProne</a>(Target-&gt;GetTechnoType());
<a name="l00266"></a>00266                 pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#b5d24ee2a760bfd6da810dee4610dd31">ImmuneToEMPSet</a> = <span class="keyword">true</span>;
<a name="l00267"></a>00267         }
<a name="l00268"></a>00268 
<a name="l00269"></a>00269         <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#7313727d1b8e4c0f6b4d3a60150215e7">ImmuneToEMP</a>) {
<a name="l00270"></a>00270                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00271"></a>00271                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is ImmuneToEMP.\n"</span>, Target-&gt;get_ID());
<a name="l00272"></a>00272                 }
<a name="l00273"></a>00273                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00274"></a>00274         }
<a name="l00275"></a>00275 
<a name="l00276"></a>00276         <span class="comment">// this may be immune because of veteran and elite abilities.</span>
<a name="l00277"></a>00277         <span class="keywordflow">if</span> (Target-&gt;Veterancy.IsElite() &amp;&amp; (pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#2116994c254b89f1ad9f3e6659e18d5a">EliteAbilityEMPIMMUNE</a> || pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#3e84dd16f4eebc772e0d6d849fc589ec">VeteranAbilityEMPIMMUNE</a>)) {
<a name="l00278"></a>00278                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00279"></a>00279                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is immune because it is elite.\n"</span>, Target-&gt;get_ID());
<a name="l00280"></a>00280                 }
<a name="l00281"></a>00281                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00282"></a>00282         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Target-&gt;Veterancy.IsVeteran() &amp;&amp; pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#3e84dd16f4eebc772e0d6d849fc589ec">VeteranAbilityEMPIMMUNE</a>) {
<a name="l00283"></a>00283                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00284"></a>00284                         Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is immune because it is veteran.\n"</span>, Target-&gt;get_ID());
<a name="l00285"></a>00285                 }
<a name="l00286"></a>00286                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00287"></a>00287         }
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         <span class="comment">// if houses differ, TypeImmune does not count.</span>
<a name="l00290"></a>00290         <span class="keywordflow">if</span> (Target-&gt;Owner == SourceHouse) {
<a name="l00291"></a>00291                 <span class="comment">// ignore if type immune. don't even try.</span>
<a name="l00292"></a>00292                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#42ff43d73b38e829f54e42f5ca5daade" title="Gets whether a Techno is type immune to EMP.">isEMPTypeImmune</a>(Target)) {
<a name="l00293"></a>00293                         <span class="comment">// This unit can fire emps and type immunity</span>
<a name="l00294"></a>00294                         <span class="comment">// grants it to never be affected.</span>
<a name="l00295"></a>00295                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00296"></a>00296                                 Debug::Log(<span class="stringliteral">"[isEMPImmune] \"%s\" is TypeImmune.\n"</span>, Target-&gt;get_ID());
<a name="l00297"></a>00297                         }
<a name="l00298"></a>00298                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00299"></a>00299                 }
<a name="l00300"></a>00300         }
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00303"></a>00303 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="42ff43d73b38e829f54e42f5ca5daade"></a><!-- doxytag: member="EMPulse::isEMPTypeImmune" ref="42ff43d73b38e829f54e42f5ca5daade" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::isEMPTypeImmune           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Target</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether a Techno is type immune to EMP. 
<p>
Type immunity does work a little different for EMP weapons than for ordinary projectiles. Target is type immune to EMP if it has a weapon that uses a warhead also having EMP.Duration set. It is irrelevant which Techno fired the EMP.<p>
If Target is elite, only EliteWeapons are used to check for a non-zero EMP.Duration, otherwise only ordinary Weapons are used.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Target</em>&nbsp;</td><td>The Techno to check EMP type immunity for.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Target is type immune to EMP, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00218"></a>00218                                                   {
<a name="l00219"></a>00219         <span class="comment">// find an emp weapon.</span>
<a name="l00220"></a>00220         TechnoTypeClass *TT = Target-&gt;GetTechnoType();
<a name="l00221"></a>00221         <span class="keywordflow">if</span> (TT-&gt;TypeImmune) {
<a name="l00222"></a>00222                 <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 18; ++i) {
<a name="l00223"></a>00223                         WeaponTypeClass *WeaponType = (!Target-&gt;Veterancy.IsElite())
<a name="l00224"></a>00224                                 ? TT-&gt;get_Weapon(i)
<a name="l00225"></a>00225                                 : TT-&gt;get_EliteWeapon(i);
<a name="l00226"></a>00226                         <span class="keywordflow">if</span> (!WeaponType) {
<a name="l00227"></a>00227                                 <span class="keywordflow">continue</span>;
<a name="l00228"></a>00228                         }
<a name="l00229"></a>00229 
<a name="l00230"></a>00230                         WarheadTypeClass *WarheadType = WeaponType-&gt;Warhead;
<a name="l00231"></a>00231                         <span class="keywordflow">if</span> (<a class="code" href="class_warhead_type_ext_1_1_ext_data.html">WarheadTypeExt::ExtData</a> *pWH = <a class="code" href="class_warhead_type_ext.html#b2eb86c684fe6f15f9f95a9aa171e7dd">WarheadTypeExt::ExtMap</a>.Find(WarheadType)) {
<a name="l00232"></a>00232                                 <span class="keywordflow">if</span> (pWH-&gt;EMP_Duration != 0) {
<a name="l00233"></a>00233                                         <span class="comment">// this unit can fire emps and type immunity</span>
<a name="l00234"></a>00234                                         <span class="comment">// grants it to never be affected.</span>
<a name="l00235"></a>00235                                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00236"></a>00236                                 }
<a name="l00237"></a>00237                         }
<a name="l00238"></a>00238                 }
<a name="l00239"></a>00239         }
<a name="l00240"></a>00240 
<a name="l00241"></a>00241         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00242"></a>00242 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="cae411b2800c152fdb7647c912a421e0"></a><!-- doxytag: member="EMPulse::IsTypeEMPProne" ref="cae411b2800c152fdb7647c912a421e0" args="(TechnoTypeClass *Type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::IsTypeEMPProne           </td>
          <td>(</td>
          <td class="paramtype">TechnoTypeClass *&nbsp;</td>
          <td class="paramname"> <em>Type</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Gets whether an EMP would have an effect on a TechnoType. 
<p>
Infantry that has Cyborg set is prone to EMP.<p>
Non-Infantry Foots are prone only if they aren't organic.<p>
Buildings with special functions like Radar, SuperWeapon, PowersUnit, Sensors, LaserFencePost, GapGenerator and UndeploysInto are prone. Otherwise a Building is prone if it consumes power and is Powered.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Type</em>&nbsp;</td><td>The TechnoType to get the susceptibility to EMP of.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Type is prone to EMPs, false otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-30 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00354"></a>00354                                                    {
<a name="l00355"></a>00355         <span class="keywordtype">bool</span> prone = <span class="keyword">true</span>;
<a name="l00356"></a>00356 
<a name="l00357"></a>00357         <span class="comment">// buildings are emp prone if they consume power and need it to function</span>
<a name="l00358"></a>00358         <span class="keywordflow">if</span> (BuildingTypeClass * BuildingType = specific_cast&lt;BuildingTypeClass *&gt;(Type)) {
<a name="l00359"></a>00359                 prone = (BuildingType-&gt;Powered &amp;&amp; (BuildingType-&gt;PowerDrain &gt; 0));
<a name="l00360"></a>00360 
<a name="l00361"></a>00361                 <span class="comment">// may have a special function.</span>
<a name="l00362"></a>00362                 <span class="keywordflow">if</span> (BuildingType-&gt;Radar ||
<a name="l00363"></a>00363                         (BuildingType-&gt;SuperWeapon&gt; -1) || (BuildingType-&gt;SuperWeapon2 &gt; -1)
<a name="l00364"></a>00364                         || BuildingType-&gt;UndeploysInto
<a name="l00365"></a>00365                         || BuildingType-&gt;PowersUnit
<a name="l00366"></a>00366                         || BuildingType-&gt;Sensors
<a name="l00367"></a>00367                         || BuildingType-&gt;LaserFencePost
<a name="l00368"></a>00368                         || BuildingType-&gt;GapGenerator) {
<a name="l00369"></a>00369                                 prone = <span class="keyword">true</span>;
<a name="l00370"></a>00370                 }
<a name="l00371"></a>00371         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (InfantryTypeClass * InfantryType = specific_cast&lt;InfantryTypeClass *&gt;(Type)) {
<a name="l00372"></a>00372                 <span class="comment">// affected only if this is a cyborg.</span>
<a name="l00373"></a>00373                 prone = InfantryType-&gt;Cyborg_;
<a name="l00374"></a>00374         } <span class="keywordflow">else</span> {
<a name="l00375"></a>00375                 <span class="comment">// if this is a vessel or vehicle that is organic: no effect.</span>
<a name="l00376"></a>00376                 prone = !Type-&gt;Organic;
<a name="l00377"></a>00377         }
<a name="l00378"></a>00378 
<a name="l00379"></a>00379         <span class="keywordflow">return</span> prone;
<a name="l00380"></a>00380 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="f4b3b9b8ea4b6259de2b9d7f0c1d0c37"></a><!-- doxytag: member="EMPulse::thresholdExceeded" ref="f4b3b9b8ea4b6259de2b9d7f0c1d0c37" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EMPulse::thresholdExceeded           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Victim</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks whether a Techno should be considered destroyed. 
<p>
A techno can be destroyed by excessive EMP damage. If the treshold is positive it acts as a upper limit. If it is negative it is only a limit if the unit is in the air.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Victim</em>&nbsp;</td><td>The Techno that is under EMP effect.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>True if Victim has taken too much EMP damage, False otherwise.</dd></dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-20 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00669"></a>00669                                                     {
<a name="l00670"></a>00670         <a class="code" href="class_techno_type_ext_1_1_ext_data.html">TechnoTypeExt::ExtData</a> *pData = <a class="code" href="class_techno_type_ext.html#cc5f01db1b341572a92ad754a7d15c48">TechnoTypeExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Victim-&gt;GetTechnoType());
<a name="l00671"></a>00671 
<a name="l00672"></a>00672         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00673"></a>00673                 Debug::Log(<span class="stringliteral">"[thresholdExceeded] %s: %d %d\n"</span>, Victim-&gt;get_ID(), pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#01a75dbe28a842e258e3ffc2ff1260a1">EMPThreshold</a>, Victim-&gt;EMPLockRemaining);
<a name="l00674"></a>00674         }
<a name="l00675"></a>00675 
<a name="l00676"></a>00676         <span class="keywordflow">if</span> ((pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#01a75dbe28a842e258e3ffc2ff1260a1">EMPThreshold</a> != 0) &amp;&amp; (Victim-&gt;EMPLockRemaining &gt; (DWORD)abs(pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#01a75dbe28a842e258e3ffc2ff1260a1">EMPThreshold</a>))) {
<a name="l00677"></a>00677                 <span class="keywordflow">if</span> ((pData-&gt;<a class="code" href="class_techno_type_ext_1_1_ext_data.html#01a75dbe28a842e258e3ffc2ff1260a1">EMPThreshold</a> &gt; 0) || Victim-&gt;IsInAir()) {
<a name="l00678"></a>00678                         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00679"></a>00679                 }
<a name="l00680"></a>00680         }
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00683"></a>00683 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="e45b8d77bd3cd58bb1bfaf647af2656b"></a><!-- doxytag: member="EMPulse::updateRadarBlackout" ref="e45b8d77bd3cd58bb1bfaf647af2656b" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateRadarBlackout           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the radar outage for the owning player to match the current EMP effect duration. 
<p>
The radar outage duration will be set to the number of frames the current EMP effect lasts. If there is no EMP in effect, the radar is set to come back online.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be a Radar structure.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-04-27 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00498"></a>00498                                                       {
<a name="l00499"></a>00499         <span class="keywordflow">if</span> (BuildingClass * Building = specific_cast&lt;BuildingClass *&gt;(Techno)) {
<a name="l00500"></a>00500                 <span class="keywordflow">if</span> (!Building-&gt;Type-&gt;InvisibleInGame) {
<a name="l00501"></a>00501                         <span class="keywordflow">if</span> (Building-&gt;Type-&gt;Radar) {
<a name="l00502"></a>00502                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00503"></a>00503                                         Debug::Log(<span class="stringliteral">"[updateRadarBlackout] Before: %d, %d\n"</span>,
<a name="l00504"></a>00504                                                         Building-&gt;EMPLockRemaining,
<a name="l00505"></a>00505                                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft);
<a name="l00506"></a>00506                                 }
<a name="l00507"></a>00507                                 <span class="keywordflow">if</span> (Building-&gt;EMPLockRemaining &gt; 0) {
<a name="l00508"></a>00508                                         Building-&gt;Owner-&gt;CreateRadarOutage(Building-&gt;EMPLockRemaining);
<a name="l00509"></a>00509                                         <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00510"></a>00510                                                 Debug::Log(<span class="stringliteral">"[enableEMPEffect] Radar down for: %d\n"</span>, Building-&gt;EMPLockRemaining);
<a name="l00511"></a>00511                                         }
<a name="l00512"></a>00512                                 } <span class="keywordflow">else</span> {
<a name="l00513"></a>00513                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft = 0;
<a name="l00514"></a>00514                                         Building-&gt;Owner-&gt;RadarBlackout = <span class="keyword">true</span>; <span class="comment">// trigger the radar outage check</span>
<a name="l00515"></a>00515                                 }
<a name="l00516"></a>00516                                 <span class="keywordflow">if</span> (<a class="code" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307" title="Enables verbose debug output for some WarheadTypeExt functions.">verbose</a>) {
<a name="l00517"></a>00517                                         Debug::Log(<span class="stringliteral">"[updateRadarBlackout] After: %d\n"</span>,
<a name="l00518"></a>00518                                                         Building-&gt;Owner-&gt;RadarBlackoutTimer.TimeLeft);
<a name="l00519"></a>00519                                 }
<a name="l00520"></a>00520                         }
<a name="l00521"></a>00521                 }
<a name="l00522"></a>00522         }
<a name="l00523"></a>00523 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="9861f36902003925c8aaea5082f0121b"></a><!-- doxytag: member="EMPulse::updateSlaveManager" ref="9861f36902003925c8aaea5082f0121b" args="(TechnoClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateSlaveManager           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the SlaveManager to account for the EMP effect. 
<p>
Stops the slaves where they are standing until the EMP effect is over.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be an enslaver.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-07 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00569"></a>00569                                                      {
<a name="l00570"></a>00570         <span class="keywordflow">if</span> (SlaveManagerClass *SM = Techno-&gt;SlaveManager) {
<a name="l00571"></a>00571                 
<a name="l00572"></a>00572                 <span class="keywordflow">if</span> (Techno-&gt;EMPLockRemaining &gt; 0) {
<a name="l00573"></a>00573                         <span class="comment">// pause the timers so spawning and regenerating is deferred.</span>
<a name="l00574"></a>00574                         SM-&gt;RespawnTimer.StartTime = -1;
<a name="l00575"></a>00575                 } <span class="keywordflow">else</span> {
<a name="l00576"></a>00576                         <span class="comment">// resume slaving around.</span>
<a name="l00577"></a>00577                         SM-&gt;RespawnTimer.StartIfEmpty();
<a name="l00578"></a>00578                 }
<a name="l00579"></a>00579         }
<a name="l00580"></a>00580 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="61f0c37d20dc3bc29f34d497b456c239"></a><!-- doxytag: member="EMPulse::UpdateSparkleAnim" ref="61f0c37d20dc3bc29f34d497b456c239" args="(TechnoClass *Techno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::UpdateSparkleAnim           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the sparkle animation of Techno. 
<p>
Enables or disables the EMP sparkle animation.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno to update.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-09 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00591"></a>00591                                                     {
<a name="l00592"></a>00592         <a class="code" href="class_techno_ext_1_1_ext_data.html">TechnoExt::ExtData</a> *pData = <a class="code" href="class_techno_ext.html#3cdb7f8ccc49548f0b621ff80df0e8fb">TechnoExt::ExtMap</a>.<a class="code" href="class_container.html#90ddec0f8fb14f5a9894e128c2f938fc">Find</a>(Techno);
<a name="l00593"></a>00593         <span class="keywordflow">if</span> (pData) {
<a name="l00594"></a>00594                 <span class="keywordflow">if</span> (Techno-&gt;IsUnderEMP()) {
<a name="l00595"></a>00595                         <span class="keywordflow">if</span> (!pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a> &amp;&amp; RulesClass::Instance-&gt;EMPulseSparkles) {
<a name="l00596"></a>00596                                 GAME_ALLOC(AnimClass, pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>, RulesClass::Instance-&gt;EMPulseSparkles, &amp;Techno-&gt;Location);
<a name="l00597"></a>00597                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>-&gt;SetOwnerObject(Techno);
<a name="l00598"></a>00598                         }
<a name="l00599"></a>00599                 } <span class="keywordflow">else</span> {
<a name="l00600"></a>00600                         <span class="keywordflow">if</span> (pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>) {
<a name="l00601"></a>00601                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a>-&gt;RemainingIterations = 0; <span class="comment">// basically "you don't need to show up anymore"</span>
<a name="l00602"></a>00602                                 pData-&gt;<a class="code" href="class_techno_ext_1_1_ext_data.html#c100c6c6c523f931ec6efef760c50a84">EMPSparkleAnim</a> = NULL;
<a name="l00603"></a>00603                         }
<a name="l00604"></a>00604                 }
<a name="l00605"></a>00605         }
<a name="l00606"></a>00606 }
</pre></div>
<p>

</div>
</div><p>
<a class="anchor" name="b8e45e0a1a4ed89481378782b5ef9d7e"></a><!-- doxytag: member="EMPulse::updateSpawnManager" ref="b8e45e0a1a4ed89481378782b5ef9d7e" args="(TechnoClass *, ObjectClass *)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void EMPulse::updateSpawnManager           </td>
          <td>(</td>
          <td class="paramtype">TechnoClass *&nbsp;</td>
          <td class="paramname"> <em>Techno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ObjectClass *&nbsp;</td>
          <td class="paramname"> <em>Source</em> = <code>NULL</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [static, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Updates the SpawnManager to account for the EMP effect. 
<p>
Defers all regeneration and spawning until after the EMP effect is over. If spawned units are on the go, that is, launching or flying, they are destroyed.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>Techno</em>&nbsp;</td><td>The Techno that might be a spawner.</td></tr>
  </table>
</dl>
<dl class="author" compact><dt><b>Author:</b></dt><dd>AlexB </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>2010-05-03 </dd></dl>
<div class="fragment"><pre class="fragment"><a name="l00536"></a>00536                                                                                   {
<a name="l00537"></a>00537         <span class="keywordflow">if</span> (SpawnManagerClass *SM = Techno-&gt;SpawnManager) {
<a name="l00538"></a>00538                 
<a name="l00539"></a>00539                 <span class="keywordflow">if</span> (Techno-&gt;EMPLockRemaining &gt; 0) {
<a name="l00540"></a>00540                         <span class="comment">// crash all spawned units that are visible. else, they'd land somewhere else.</span>
<a name="l00541"></a>00541                         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; SM-&gt;SpawnedNodes.Count; ++i) {
<a name="l00542"></a>00542                                 SpawnNode *spawn = SM-&gt;SpawnedNodes.GetItem(i);
<a name="l00543"></a>00543                                 <span class="comment">// kill every spawned unit that is in the air. exempt missiles.</span>
<a name="l00544"></a>00544                                 <span class="keywordflow">if</span>(!spawn-&gt;IsSpawnMissile &amp;&amp; spawn-&gt;Unit &amp;&amp; spawn-&gt;Status &gt;= 0 &amp;&amp; spawn-&gt;Status &lt;= 4) {
<a name="l00545"></a>00545                                         spawn-&gt;Unit-&gt;Crash(Source);
<a name="l00546"></a>00546                                 }
<a name="l00547"></a>00547                         }
<a name="l00548"></a>00548 
<a name="l00549"></a>00549                         <span class="comment">// pause the timers so spawning and regenerating is deferred.</span>
<a name="l00550"></a>00550                         SM-&gt;SpawnTimer.StartTime = -1;
<a name="l00551"></a>00551                         SM-&gt;UnknownTimer.StartTime = -1;
<a name="l00552"></a>00552                 } <span class="keywordflow">else</span> {
<a name="l00553"></a>00553                         <span class="comment">// resume counting.</span>
<a name="l00554"></a>00554                         SM-&gt;SpawnTimer.StartIfEmpty();
<a name="l00555"></a>00555                         SM-&gt;UnknownTimer.StartIfEmpty();
<a name="l00556"></a>00556                 }
<a name="l00557"></a>00557         }
<a name="l00558"></a>00558 }
</pre></div>
<p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="c5be0a3f0350827da617ba594d1cd307"></a><!-- doxytag: member="EMPulse::verbose" ref="c5be0a3f0350827da617ba594d1cd307" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_e_m_pulse.html#c5be0a3f0350827da617ba594d1cd307">EMPulse::verbose</a> = true<code> [static, protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Enables verbose debug output for some <a class="el" href="class_warhead_type_ext.html">WarheadTypeExt</a> functions. 
<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following files:<ul>
<li>Misc/<a class="el" href="_e_m_pulse_8h.html">EMPulse.h</a><li>Misc/<a class="el" href="_e_m_pulse_8cpp.html">EMPulse.cpp</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Sat May 29 11:15:58 2010 for Ares by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
